(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{211:function(e,t){},317:function(e,t,a){e.exports=a(449)},336:function(e,t,a){},337:function(e,t,a){},344:function(e,t,a){},421:function(e,t,a){},422:function(e,t,a){},439:function(e,t){},449:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(29),i=a.n(r),l=a(274),s=a(109),c=a(19),d=a(17),p=a(26),u=a(25),m=a(27),h=a(161),g=a(543),f=new(a(209).EventEmitter),v=(a(336),function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={key:null},a.handleCloseClick=function(e){a.props.closeSnackbar(e)},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=function(t){return o.a.createElement(o.a.Fragment,null,o.a.createElement(g.a,{className:"snackbar-btn white-text",onClick:e.handleCloseClick.bind(e,t)},"DISMISS"))};this.showSnackbarListener=f.addListener("showSnackbar",function(a,n){console.log(n),e.props.enqueueSnackbar(n,{variant:a,autoHideDuration:3e3,action:t})}),this.showloggingSnackbarListener=f.addListener("showloggingSnackbar",function(t){var a="Logging to ".concat(t,"..."),n=e.props.enqueueSnackbar(a,{variant:"info",persist:!0});e.setState({key:n})}),this.hideloggingSnackbarListener=f.addListener("hideloggingSnackbar",function(){e.props.closeSnackbar(e.state.key)})}},{key:"componentWillUnmount",value:function(){f.removeListener(this.showSnackbarListener),f.removeListener(this.showloggingSnackbarListener),f.removeListener(this.hideloggingSnackbarListener)}},{key:"render",value:function(){return o.a.createElement("div",null)}}]),t}(o.a.Component)),y=Object(h.withSnackbar)(v),b=a(54),x=a.n(b),C={root:{position:"fixed",top:0,zIndex:900},logoContainer:{height:"60px"},logo:{height:"55px"},flexContainer:{position:"absolute",right:12,display:"flex",flexDirection:"row-reverse",justifyContent:"flex-start"},svgIcon:{width:24,height:24},fontIcon:{fontSize:29},toolbar:{background:"#89ca92"}},E=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={modal:null},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("DOMContentLoaded",function(){var t=document.getElementById("about"),a=x.a.Modal.init(t);e.setState({modal:a})})}},{key:"componentWillUnmount",value:function(){this.state.modal.destory()}},{key:"render",value:function(){return o.a.createElement("div",{id:"about",className:"modal"},o.a.createElement("div",{className:"modal-content"},o.a.createElement("h4",null,"About"),o.a.createElement("p",null,"Designed & Written by\xa0",o.a.createElement("a",{href:"https://evenor-tech.com/"},"Evenor-Tech"),"."),o.a.createElement("p",null,o.a.createElement("a",{style:C.logoContainer,href:"https://www.steambioafrica.com/"},o.a.createElement("img",{style:C.logo,src:"./static/assets/eu.png",alt:""})))),o.a.createElement("div",{className:"modal-footer"},o.a.createElement("button",{className:"modal-close waves-effect waves-light btn-flat"},"OK")))}}]),t}(o.a.Component),S=a(544),w=a(545),k=a(453),L=a(456),I=a(546),O=a(113),D=a(542),T=a(253),P=a.n(T),B=Object(O.b)({palette:{primary:{main:P.a[900]}}}),j={root:{position:"fixed",top:0,zIndex:900},logoContainer:{height:"60px"},logo:{height:"55px"},flexContainer:{position:"absolute",right:12,display:"flex",flexDirection:"row-reverse",justifyContent:"flex-start"},svgIcon:{width:24,height:24},fontIcon:{fontSize:29,color:"#FFFFFF"},toolbar:{background:"#89ca92"}},A=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={loggedin:!1,token:null},a.handleLoginClick=function(){f.emit("login")},a.handleLogoutClick=function(){f.emit("removeAllLayer"),f.emit("removeDataset"),f.emit("removeAllDataset"),f.emit("handleDatasetRemove"),localStorage.removeItem("token"),localStorage.removeItem("jwt"),document.cookie.split(";").forEach(function(e){document.cookie=e.replace(/^ +/,"").replace(/=.*/,"=;expires="+(new Date).toUTCString()+";path=/")}),f.emit("showSnackbar","success","Logout successfully."),a.setState({token:null,loggedin:!1})},a.handleToken=function(e){console.log("Received token:",e),a.setState({token:e})},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setLoginStateListener=f.addListener("setLoginState",function(t){e.setState({loggedin:t})}),f.on("handleToken",this.handleToken)}},{key:"componentWillUnmount",value:function(){f.removeListener(this.setLoginStateListener)}},{key:"render",value:function(){return o.a.createElement(D.a,{theme:B},o.a.createElement(S.a,{style:j.root,position:"static"},o.a.createElement(w.a,{style:j.toolbar},o.a.createElement("a",{style:j.logoContainer,href:"https://evenor-tech.com/"},o.a.createElement("img",{style:j.logo,src:"./static/assets/logo.png",alt:""})),"\xa0 \xa0 \xa0 \xa0",o.a.createElement("a",{style:j.logoContainer,href:"https://tepro.es/"},o.a.createElement("img",{style:j.logo,src:"./static/assets/tepro_.png",alt:""})),o.a.createElement("div",{style:j.flexContainer},o.a.createElement(k.a,{title:"About","aria-label":"About",enterDelay:200},o.a.createElement(L.a,{className:"icon-container modal-trigger","aria-label":"About",color:"inherit","data-target":"about"},o.a.createElement(I.a,{style:j.fontIcon},"info_outline"))),o.a.createElement(k.a,{title:"User Manual","aria-label":"User Manual",enterDelay:200},o.a.createElement("a",{href:"https://tepro.es/",target:"_blank",rel:"noopener noreferrer",download:!0},o.a.createElement(L.a,{className:"icon-container modal-trigger","aria-label":"User Manual",color:"inherit","data-target":"user_manual"},o.a.createElement(I.a,{style:j.fontIcon},"picture_as_pdf_icon"))))))))}}]),t}(o.a.Component),F=a(595),R=a(596),_=a(547),U=(a(337),{root:{position:"fixed",right:24,bottom:24,zIndex:1e3}}),M=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={open:!1,actions:[{name:"Cambiar Estilo",icon:o.a.createElement(I.a,null,"brush"),color:"red accent-2",callback:function(){f.emit("closeAllController"),f.emit("openStyleController"),a.handleClose()}},{name:"Collect indexes",icon:o.a.createElement(I.a,null,"satellite"),color:"grey",callback:function(){f.emit("closeAllController"),f.emit("openBandController"),a.handleClose()}},{name:"Spatiotemporal Analysis",icon:o.a.createElement(I.a,null,"satellite_alt"),color:"orange",callback:function(){f.emit("closeAllController"),a.handleClose()}},{name:"Vegetation Index Change Inspector",icon:o.a.createElement(I.a,null,"image_search"),color:"blue",callback:function(){f.emit("closeAllController"),f.emit("openVegInspectorController"),a.handleClose()}},{name:"Biodiversity Indexes",icon:o.a.createElement(I.a,null,"pets"),color:"purple darken-1",callback:function(){f.emit("closeAllController"),f.emit("openBiodivController"),a.handleClose()}},{name:"Modelo Rusle",icon:o.a.createElement(I.a,null,"landslide"),color:"#490EFF",callback:function(){f.emit("closeAllController"),f.emit("openRusleController"),a.handleClose()}},{name:"Models",icon:o.a.createElement(I.a,null,"psychology"),color:"purple darken-1",callback:function(){f.emit("closeAllController"),f.emit("openModelController"),a.handleClose()}},{name:"Buscar Parcela",icon:o.a.createElement(I.a,null,"search"),color:"leaf green",callback:function(){f.emit("closeAllController"),f.emit("openSearchController"),a.handleClose()}},{name:"Visualizador de Capas",icon:o.a.createElement(I.a,null,"grass"),color:"green",callback:function(){f.emit("closeAllController"),f.emit("openBushEncoracherController"),a.handleClose()}},{name:"Configurador de Capas",icon:o.a.createElement(I.a,null,"layers"),color:"yellow darken-1",callback:function(){f.emit("closeAllController"),f.emit("openLayerController"),a.handleClose()}}]},a.handleClick=function(){a.setState(function(e){return{open:!e.open}})},a.handleOpen=function(){a.setState({open:!0})},a.handleClose=function(){a.setState({open:!1})},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.openMenuListener=f.addListener("openMenu",function(){e.setState({open:!0})})}},{key:"componentWillUnmount",value:function(){f.removeListener(this.openMenuListener)}},{key:"render",value:function(){return o.a.createElement(F.a,{style:U.root,open:this.state.open,ariaLabel:"Menu",icon:o.a.createElement(R.a,{icon:o.a.createElement(I.a,null,"menu"),openIcon:o.a.createElement(I.a,null,"clear")}),onMouseEnter:this.handleOpen,onMouseLeave:this.handleClose,onClick:this.handleClick},this.state.actions.map(function(e){return o.a.createElement(_.a,{key:e.name,className:e.color,icon:e.icon,tooltipTitle:e.name,onClick:e.callback})}))}}]),t}(o.a.Component),W=a(16),N=a.n(W),z=a(31),H=a(255),V=a.n(H),q=a(585),G=a(553),Z=a(548),J=a(234),Y=a(597),$=a(189),K=a(44),Q=a.n(K),X=a(576),ee=a(211),te=a.n(ee),ae=a(574);ae.a.defaults.baseURL="http://localhost:5000",ae.a.defaults.withCredentials=!0;var ne=Object(O.b)({palette:{primary:{main:Q.a.A200}}}),oe=["41046A010000100000DU","41041A014001860000HF","41041A014001790000HQ","41041A015002920000HF","41041A015002760000HH","41041A015002730000HS","41041A014000920000HF","41041A007003790000HK","41041A005000430000HO"];ae.a.interceptors.request.use(function(e){var t=new URL(e.url).origin,a=["http://localhost:5000"],n=localStorage.getItem("token");return a.includes(t)&&(e.headers.authorization="Bearer ".concat(n)),e},function(e){return Promise.reject(e)});var re={loginContainer:{width:300,height:350,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},title:{marginBottom:20},inputBox:{width:240,marginTop:15},autocomplete:{width:240,display:"flex",flexWrap:"wrap",overflow:"auto"},checkBox:{width:140},loginBtnContainer:{display:"inline-block",position:"relative"},loginBtn:{width:120,marginTop:20},loginBtnProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-3,marginLeft:-12}},ie=o.a.forwardRef(function(e,t){return o.a.createElement(J.a,Object.assign({direction:"down",ref:t},e))}),le=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={open:!1,remember:!1,logining:!1,mode:"login",selectedOptions:[],datasets:{}},a.handleLoginClose=function(){a.setState({open:!1})},a.handleRememberChange=function(e){a.setState({remember:e.target.checked})},a.handleChangeForm=function(e){a.setState({mode:"login"===a.state.mode?"Login":"Register"}),console.log(a.state.mode)},a.handleChangeAutoComplete=function(e,t){var n=t.map(function(e){return e.reference});a.setState({selectedOptions:n},function(){console.log(a.state.selectedOptions)})},a.getUserParcels=function(){var e=Object(z.a)(N.a.mark(function e(t){var n;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ae.a.get("http://localhost:5000/users/".concat(t,"/parcels"));case 3:200===(n=e.sent).status?(a.updateDatasetUtilsFile(n.data),console.log("Parcelas recibidas:",n.data)):console.error("No se pudieron obtener las parcelas:",n.statusText),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error al obtener las parcelas:",e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),a.handleLoginClick=Object(z.a)(N.a.mark(function e(){var t,n,o,r;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({logining:!0}),t={username:document.getElementById("username").value,password:V()(document.getElementById("password").value)},e.next=4,ae.a.post("http://localhost:5000/login",t);case 4:200===(n=e.sent).status&&(o=n.data.message[0],r=n.data.message[1],f.emit("handleToken",r),localStorage.removeItem("token"),localStorage.removeItem("jwt"),localStorage.setItem("token",r),f.emit("showSnackbar","success","User login successfully."),f.emit("setLoginState",!0),a.getUserParcels(o),a.setState({open:!1,logining:!1,idUser:o}),console.log(localStorage.getItem("token")));case 6:case"end":return e.stop()}},e)})),a.moveDataset=function(){var e=a.state.datasets;a.setState({movedData:e}),console.log(a.state.movedData)},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"updateDatasetUtilsFile",value:function(e){e.forEach(function(e){te.a[e.catastral_ref]={data:e.geojson_data}}),this.setState({datasets:te.a}),console.log("Updated datasets:",this.state.datasets),f.emit("moveDataset",this.state.datasets)}},{key:"componentDidMount",value:function(){var e=this;this.loginListener=f.addListener("login",function(){e.setState({open:!0})}),this.moveDatasetListener=f.addListener("moveDataset",function(){e.moveDataset()})}},{key:"componentWillUnmount",value:function(){f.removeListener(this.loginListener),f.removeListener(this.moveDatasetListener)}},{key:"render",value:function(){return o.a.createElement(D.a,{theme:ne},o.a.createElement(Z.a,{open:this.state.open,TransitionComponent:ie,onClose:this.handleLoginClose},o.a.createElement("div",{style:re.loginContainer},"login"===this.state.mode?o.a.createElement(o.a.Fragment,null,o.a.createElement($.a,{style:re.title,variant:"h5",gutterBottom:!0},"Inicio de Sesi\xf3n"),o.a.createElement(Y.a,{style:re.inputBox,variant:"outlined",margin:"dense",id:"username",label:"Usuario"}),o.a.createElement(Y.a,{style:re.inputBox,variant:"outlined",margin:"dense",id:"password",type:"password",label:"Contrase\xf1a"})):o.a.createElement(o.a.Fragment,null,o.a.createElement($.a,{style:re.title,variant:"h5",gutterBottom:!0},"Registro"),o.a.createElement(Y.a,{style:re.inputBox,variant:"outlined",margin:"dense",id:"username",label:"Usuario"}),o.a.createElement(Y.a,{style:re.inputBox,variant:"outlined",margin:"dense",id:"password",type:"password",label:"Contrase\xf1a"}),o.a.createElement(X.a,{style:re.inputBox,multiple:!0,onChange:this.handleChangeAutoComplete,limitTags:1,id:"checkboxes-tags-demo",options:oe,getOptionLabel:function(e){return e},renderOption:function(e,t){var a=t.selected;return o.a.createElement(o.a.Fragment,null,o.a.createElement(q.a,{style:{marginRight:1,marginLeft:1},checked:a}),e)},renderInput:function(e){return o.a.createElement(Y.a,Object.assign({id:"lista"},e,{variant:"outlined",label:"Checkboxes",placeholder:"Favorites"}))},renderTags:function(){return null}})),o.a.createElement("div",{style:re.loginBtnContainer},o.a.createElement(g.a,{style:re.loginBtn,variant:"contained",color:"primary",disabled:this.state.logining,onClick:this.handleLoginClick},"INICIAR SESI\xd3N"),this.state.logining&&o.a.createElement(G.a,{style:re.loginBtnProgress,size:24}),o.a.createElement(g.a,{style:re.loginBtn,onClick:this.handleChangeForm,color:"primary"},"login"===this.state.mode?"Register":"Login")))))}}]),t}(o.a.Component),se=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={tapTarget:null},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("DOMContentLoaded",function(){document.getElementsByClassName("MuiSpeedDial-fab")[0].setAttribute("id","menu");var t=document.querySelectorAll(".tap-target"),a=x.a.TapTarget.init(t)[0];a.open(),e.setState({tapTarget:a})})}},{key:"componentWillUnmount",value:function(){this.state.tapTarget.destory()}},{key:"render",value:function(){return o.a.createElement("div",{className:"tap-target indigo accent-2","data-target":"menu"},o.a.createElement("div",{className:"tap-target-content white-text"},o.a.createElement("h5",null,"Welcome!")))}}]),t}(o.a.Component),ce=a(554),de=a(555),pe=a(556),ue={Streets:"mapbox://styles/mapbox/streets-v11",Light:"mapbox://styles/mapbox/light-v10",Dark:"mapbox://styles/mapbox/dark-v10",Navigation_Day:"mapbox://styles/mapbox/navigation-day-v1",Navigation_Night:"mapbox://styles/mapbox/navigation-night-v1",Satellite:"mapbox://styles/mapbox/satellite-v9",Satellite_Streets:"mapbox://styles/mapbox/satellite-streets-v11",Outdoors:"mapbox://styles/mapbox/outdoors-v11"},me=(a(344),{root:{position:"fixed",top:74,right:10,borderRadius:9,width:320,margin:0,zIndex:900,boxShadow:"-6px 6px 15px rgba(0, 0, 0, 0.15)"},content:{paddingBottom:16},header:{backgroundColor:"rgba(255,82,82,255)"},closeBtn:{position:"absolute",top:6,right:8,fontSize:22},stylePreview:{width:60,height:60,borderRadius:2,cursor:"pointer"}}),he=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={open:!1},a.handleCloseClick=function(){a.setState({open:!1})},a.handleStyleClick=function(e){f.emit("setMapStyle",e),a.handleCloseClick()},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.openStyleControllerListener=f.addListener("openStyleController",function(){e.setState({open:!0})}),this.closeAllControllerListener=f.addListener("closeAllController",function(){e.setState({open:!1})})}},{key:"componentWillUnmount",value:function(){f.removeListener(this.openStyleControllerListener),f.removeListener(this.closeAllControllerListener)}},{key:"render",value:function(){var e=this;return o.a.createElement(J.a,{direction:"left",in:this.state.open},o.a.createElement(ce.a,{style:me.root},o.a.createElement(de.a,{style:me.header},o.a.createElement($.a,{gutterBottom:!0,variant:"h5",component:"h2",style:{fontFamily:"Lato, Arial, sans-serif",color:"white",fontWeight:"3"}},"Map Styles"),o.a.createElement($.a,{variant:"body2",color:"textSecondary"},"Click to choose a map style"),o.a.createElement(L.a,{style:me.closeBtn,"aria-label":"Close",onClick:this.handleCloseClick},o.a.createElement(I.a,{fontSize:"inherit"},"chevron_right"))),o.a.createElement(de.a,{style:me.content},o.a.createElement(pe.a,{container:!0,spacing:2},Object.keys(ue).map(function(t,a){return console.log(t),o.a.createElement(pe.a,{item:!0,style:me.styleCard,key:a,xs:3},o.a.createElement("img",{src:"./static/assets/".concat(t,".png"),alt:"",className:"hoverable",style:me.stylePreview,onClick:e.handleStyleClick.bind(e,t)}))})))))}}]),t}(o.a.Component),ge=a(30),fe=a(7),ve=a(40),ye=a(598),be=a(552),xe=a(459),Ce=a(557),Ee=Object(O.b)({typography:{fontFamily:"Lato, Arial, sans-serif"},overrides:{MuiCssBaseline:{"@global":{body:{fontFamily:"Lato, Arial, sans-serif"}}}}}),Se={root:{position:"fixed",top:74,right:10,width:300,borderRadius:9,margin:0,zIndex:900,boxShadow:"-6px 6px 15px rgba(0, 0, 0, 0.15)"},header:{backgroundColor:"rgba(253,216,53,255)"},closeBtn:{position:"absolute",top:6,right:8,fontSize:22},content:{paddingBottom:16},select:{width:"100%"},layerList:{marginTop:6,paddingBottom:0},layerItem:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingLeft:2,paddingRight:5},layerText:{flexGrow:1,maxWidth:"120px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},checkbox:{marginRight:"8px"},slider:{width:"80px",marginLeft:"10px"},legend:{position:"absolute",bottom:"30px",left:"10px",background:"white",padding:"10px",fontFamily:"Arial, sans-serif",fontSize:"12px",lineHeight:"18px",color:"#333",borderRadius:"3px",boxShadow:"0 0 15px rgba(0, 0, 0, 0.2)"},legendTitle:{margin:"0 0 10px",fontSize:"14px"},legendItem:{display:"flex",alignItems:"center",marginBottom:"5px"},legendColorBox:{width:"20px",height:"10px",display:"inline-block",marginRight:"5px"},spectralLegend:{position:"absolute",bottom:"30px",left:"10px",background:"white",padding:"10px",fontFamily:"Arial, sans-serif",fontSize:"12px",lineHeight:"18px",color:"#333",borderRadius:"3px",boxShadow:"0 0 15px rgba(0, 0, 0, 0.2)"}},we=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={open:!1,mapp:null,selected:{},resolution:7,zoom:0,layerForm:"Border",datasets:{},layers:[],assets:[],selectedAsset:"",mapUrl:""},a.handleCloseClick=function(){a.setState({open:!1})},a.truncateLayerName=function(e){return e.length>7?e.substring(0,4)+"...":e},a.handleDatasetChange=function(){var e=Object(z.a)(N.a.mark(function e(t){var n,o;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=!1,Object.keys(a.state.selected).map(function(e){return n=!0,a.setState({selected:{}}),!0}),!n&&t.target.value.length&&(o=t.target.value[t.target.value.length-1],f.emit("showSnackbar","default","Downloading dataset '".concat(o,"'.")),f.emit("displayDataset",o,a.state.datasets[o].data,"#f08"),f.emit("showSnackbar","success","Dataset '".concat(o,"' downloaded successfully.")));case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleShapeChange=function(e){a.setState({shape:e.target.value})},a.handleLayerVisibilityChange=function(e){var t=a.state.layers.map(function(t){return t.id===e?Object(ve.a)({},t,{visible:!t.visible}):t});a.setState({layers:t}),f.emit("toggleLayerVisibility",e,t.find(function(t){return t.id===e}).visible)},a.handleTransparencyChange=function(e,t){var n=a.state.layers.map(function(a){return a.id===e?Object(ve.a)({},a,{transparency:t}):a});a.setState({layers:n}),f.emit("changeLayerTransparency",e,t/100)},a.splitAssetName=function(e){var t=e.split("/"),a=t[t.length-1];return a.startsWith("0")&&(a=a.substring(1)),a},a.handleDrop=function(e){e.preventDefault();var t=e.dataTransfer.files;if(t.length>0){var n=t[0],o=new FileReader;o.onload=function(e){var t=JSON.parse(e.target.result),o={id:n.name,visible:!0,transparency:100};a.setState(function(e){return{datasets:Object(ve.a)({},e.datasets,Object(fe.a)({},n.name,{data:t})),layers:[].concat(Object(ge.a)(e.layers),[o])}}),f.emit("displayDataset",n.name,t),f.emit("showSnackbar","success","Dataset '".concat(n.name,"' added as a layer successfully."))},o.readAsText(n)}},a.getLegendContent=function(e){if(e.includes("VICI"))return o.a.createElement("div",{style:{padding:"10px",textAlign:"center"}},o.a.createElement($.a,null,o.a.createElement("strong",null,"Vegetation Change")," %/year"),o.a.createElement("div",{style:{width:"100%",height:"20px",background:"linear-gradient(to right, red, white, green)",margin:"10px 0",borderRadius:"5px"}}),o.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},o.a.createElement($.a,{variant:"body2"},"-2"),o.a.createElement($.a,{variant:"body2"},"2")),o.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},o.a.createElement($.a,{variant:"body2"},"Decline"),o.a.createElement($.a,{variant:"body2"},"Increase")));if(e.includes("Erosion"))return o.a.createElement("div",null,o.a.createElement($.a,null,o.a.createElement("strong",null,"Soil Loss")," (t/hac/year)"),["#490EFF","#12F4FF","#12FF50","#E5FF12","#FF4812"].map(function(e,t){return o.a.createElement("div",{key:t,style:{display:"flex",alignItems:"center"}},o.a.createElement("span",{style:{width:"20px",height:"20px",backgroundColor:e,marginRight:"10px"}}),o.a.createElement($.a,null,["Slight (<10)","Moderate (10-20)","High (20-30)","Very high (30-40)","Severe (>40)"][t]))}));if(e.includes("DSM"))return o.a.createElement("div",null,o.a.createElement($.a,null,o.a.createElement("strong",null,"DSM")," (t/ha)"),["#ffffe5","#fee391","#fec44f","#ec7014","#8c2d04"].map(function(e,t){return o.a.createElement("div",{key:t,style:{display:"flex",alignItems:"center"}},o.a.createElement("span",{style:{width:"20px",height:"20px",backgroundColor:e,marginRight:"10px"}}),o.a.createElement($.a,null,["0 - 1.2","1.2 - 2.4","2.4 - 3.6","3.6 - 4.8","4.8 - 6"][t]))}));if(e.includes("avg"))return o.a.createElement("div",null,o.a.createElement($.a,null,o.a.createElement("strong",null,"Habitat Suitability")),["#ffffff","#cceacc","#66bf66","#006600"].map(function(e,t){return o.a.createElement("div",{key:t,style:{display:"flex",alignItems:"center"}},o.a.createElement("span",{style:{width:"20px",height:"20px",backgroundColor:e,marginRight:"10px"}}),o.a.createElement($.a,null,["Unsuitable","Low suitability","Moderate suitability","High suitability"][t]))}));if(e.includes("Suelo")){var t=["#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#FFA500","#800080","#8B0000","#A52A2A","#5F9EA0","#7FFF00","#D2691E","#6495ED","#DC143C","#00FA9A","#FFD700","#ADFF2F","#4B0082","#20B2AA","#9370DB","#3CB371","#7B68EE","#48D1CC","#C71585","#191970","#FF4500","#DA70D6","#32CD32","#4682B4","#FA8072","#778899","#8A2BE2","#00CED1","#FF1493","#2E8B57","#7CFC00","#B8860B"];return o.a.createElement("div",null,o.a.createElement($.a,null,o.a.createElement("strong",null,"Uso del Suelo")),o.a.createElement("div",{style:{maxHeight:"200px",overflowY:"auto",border:"1px solid #ccc",borderRadius:"5px",padding:"10px",marginTop:"10px"}},["Tejido urbano continuo","Tejido urbano discontinuo","Zonas industriales o comerciales","Redes viarias, ferroviarias y terrenos asociados","Zonas portuarias","Aeropuertos","Zonas de extracci\xf3n minera","Escombreras y vertederos","Zonas en construcci\xf3n","Zonas verdes urbanas","Instalaciones deportivas y recreativas","Tierras de labor en secano","Terrenos regados permanentemente","Arrozales","Vi\xf1edo","Frutales","Olivares","Prados y Praderas","Cultivos anuales asociados con cultivos permanentes","Mosaico de cultivos","Terrenos principalmente agr\xedcolas, pero con importantes espacios de vegetaci\xf3n natural","Sistemas agroforestales","Bosques de frondosas","Bosques de con\xedferas","Bosque mixto","Pastizales naturales","Landas y matorrales","Matorrales escler\xf3filos","Matorral boscoso de transici\xf3n","Playas, dunas y arenales","Roquedo","Espacios con vegetaci\xf3n escasa","Zonas quemadas","Humedales y zonas pantanosas","Marismas","Salinas","Zonas llanas intermareales","Cursos de agua"].map(function(e,a){return o.a.createElement("div",{key:a,style:{display:"flex",alignItems:"center",marginBottom:"5px"}},o.a.createElement("span",{style:{width:"20px",height:"20px",backgroundColor:t[a],marginRight:"10px"}}),o.a.createElement($.a,null,e))})))}},a.handleAssetChange=function(e){var t=e.target.value.id,n=e.target.value.type;a.setState({selectedAsset:t,selectedAssetType:n}),a.fetchMapUrl(t,n)},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.openLayerControllerListener=f.addListener("openLayerController",function(){e.setState({open:!0})}),this.newLayerListener=f.addListener("newLayer",function(t){e.setState(function(e){return{layers:[].concat(Object(ge.a)(e.layers),[t])}})}),this.closeAllControllerListener=f.addListener("closeAllController",function(){e.setState({open:!1})}),this.setMapZoomListener=f.addListener("setMapZoom",function(t){e.setState({zoom:t})}),this.handleDatasetRemoveListener=f.addListener("handleDatasetRemove",function(){e.handleDatasetRemove()}),window.addEventListener("dragover",this.handleDragOver),window.addEventListener("drop",this.handleDrop)}},{key:"componentDidUpdate",value:function(e){this.props.map!==e.map&&this.updateDatasets()}},{key:"handleDatasetRemove",value:function(){this.setState({datasets:{},selected:{}})}},{key:"componentWillUnmount",value:function(){f.removeListener(this.openLayerControllerListener),f.removeListener(this.closeAllControllerListener),f.removeListener(this.setMapZoomListener),f.removeListener(this.handleDatasetRemoveListener),f.removeListener(this.newLayerListener),window.removeEventListener("dragover",this.handleDragOver),window.removeEventListener("drop",this.handleDrop)}},{key:"render",value:function(){var e=this;return console.log(this.state.layers),o.a.createElement(D.a,{theme:Ee},o.a.createElement(J.a,{direction:"left",in:this.state.open},o.a.createElement(ce.a,{style:Se.root},o.a.createElement(de.a,{style:Se.header},o.a.createElement($.a,{gutterBottom:!0,style:{fontFamily:"Lato, Arial, sans-serif",color:"white",fontWeight:"3"},variant:"h5",component:"h2"},"Layers"),o.a.createElement($.a,{variant:"body2",color:"textSecondary"},"Manage and control layers"),o.a.createElement(L.a,{style:Se.closeBtn,"aria-label":"Close",onClick:function(){return e.setState({open:!1})}},o.a.createElement(I.a,{fontSize:"inherit"},"chevron_right"))),o.a.createElement(de.a,{style:Se.content},o.a.createElement(be.a,{id:"layers",style:Se.layerList},this.state.layers.map(function(t){return o.a.createElement(xe.a,{style:Se.layerItem,key:t.id},o.a.createElement(Ce.a,{primary:o.a.createElement("span",{style:Se.layerText},o.a.createElement(k.a,{title:e.getLegendContent(t.id),arrow:!0},o.a.createElement(I.a,{fontSize:"small"},"troubleshoot")),"\xa0\xa0",o.a.createElement(k.a,{arrow:!0,title:e.splitAssetName(t.id),sx:{fontSize:"1.2rem"}},o.a.createElement("span",null,e.truncateLayerName(e.splitAssetName(t.id)))))}),o.a.createElement(q.a,{checked:t.visible,onChange:function(){return e.handleLayerVisibilityChange(t.id)},color:"primary"}),o.a.createElement(ye.a,{value:t.transparency,onChange:function(a,n){return e.handleTransparencyChange(t.id,n)},min:0,max:100,style:Se.slider}),o.a.createElement(k.a,{title:"Download this layer","aria-label":"Download this layer",enterDelay:200},o.a.createElement(L.a,{className:"icon-container modal-trigger","aria-label":"Download this layer",color:"inherit"},o.a.createElement(I.a,{style:Se.fontIcon},"download_icon"))))}))))))}}]),t}(o.a.Component),ke=a(256),Le=a.n(ke),Ie=(a(392),a(257)),Oe=a.n(Ie),De=a(258),Te=a.n(De),Pe=a(67),Be=a.n(Pe),je=function(e){var t=e.match(/^[ ]*(?:Lat: )?(-?\d+\.?\d*)[, ]+(?:Lng: )?(-?\d+\.?\d*)[ ]*$/i);if(!t)return null;var a=function(e,t){return{center:[e,t],geometry:{type:"Point",coordinates:[e,t]},place_name:"Lat: "+t+" Lng: "+e,place_type:["coordinate"],properties:{},type:"Feature"}},n=Number(t[1]),o=Number(t[2]),r=[];return(n<-90||n>90)&&r.push(a(n,o)),(o<-90||o>90)&&r.push(a(o,n)),0===r.length&&(r.push(a(n,o)),r.push(a(o,n))),r},Ae={width:200,height:200,data:new Uint8Array(16e4),onAdd:function(e){var t=document.createElement("canvas");t.width=this.width,t.height=this.height,this.context=t.getContext("2d"),this.map=e},render:function(){var e=this.context,t=performance.now()%1e3/1e3;return e.clearRect(0,0,this.width,this.height),e.beginPath(),e.arc(this.width/2,this.height/2,70*t+30,0,2*Math.PI),e.fillStyle="rgba(200, 200, 255,"+(1-t)+")",e.fill(),e.beginPath(),e.arc(this.width/2,this.height/2,30,0,2*Math.PI),e.fillStyle="rgba(100, 100, 255, 1)",e.strokeStyle="white",e.lineWidth=2+4*(1-t),e.fill(),e.stroke(),this.data=e.getImageData(0,0,this.width,this.height).data,this.map.triggerRepaint(),!0}};function Fe(e){Object.assign(this.options,e),this._ticking=!1,this._lastMouseMoveEvent=null,this._parentMap=null,this._isDragging=!1,this._isCursorOverFeature=!1,this._previousPoint=[0,0],this._currentPoint=[0,0],this._trackingRectCoordinates=[[[],[],[],[],[]]]}Fe.prototype=Object.assign({},Be.a.NavigationControl.prototype,{options:{style:"mapbox://styles/almafe2510/clw7qv6il02ok01qr9w4wdbv0",center:[0,0]},onAdd:function(e){return this._container=this._createContainer(e),this._parentMap=e,this._miniMap=new Be.a.Map({attributionControl:!1,container:this._container,style:this.options.style,center:this.options.center,zoom:0}),this._miniMap.on("load",this._load.bind(this)),this._container},_createContainer:function(e){var t=document.createElement("div");return t.id="minimap",t.className="mapboxgl-ctrl mapboxgl-ctrl-minimap",t.addEventListener("contextmenu",this._preventDefault),e.getContainer().appendChild(t),t},_preventDefault:function(e){e.preventDefault()},_load:function(){var e=this;this._zoomAdjust(),["dragPan","boxZoom","dragRotate","keyboard","doubleClickZoom","touchZoomRotate"].map(function(t){return e._miniMap[t].disable(),!0});var t=this._miniMap.getBounds();this._convertBoundsToPoints(t),this._miniMap.addSource("trackingRect",{type:"geojson",data:{type:"Feature",properties:{name:"trackingRect"},geometry:{type:"Polygon",coordinates:this._trackingRectCoordinates}}}),this._miniMap.addLayer({id:"trackingRectOutline",type:"line",source:"trackingRect",layout:{},paint:{"line-color":"#08F","line-width":1,"line-opacity":1}}),this._miniMap.addLayer({id:"trackingRectFill",type:"fill",source:"trackingRect",layout:{},paint:{"fill-color":"#08F","fill-opacity":.25}}),this._trackingRect=this._miniMap.getSource("trackingRect"),this._parentMap.on("move",this._update.bind(this)),this._parentMap.on("zoom",this._zoomAdjust.bind(this)),this._miniMap.on("mousemove",this._mouseMove.bind(this)),this._miniMap.on("mousedown",this._mouseDown.bind(this)),this._miniMap.on("mouseup",this._mouseUp.bind(this)),this._miniMap.on("touchmove",this._mouseMove.bind(this)),this._miniMap.on("touchstart",this._mouseDown.bind(this)),this._miniMap.on("touchend",this._mouseUp.bind(this)),this._miniMapCanvas=this._miniMap.getCanvasContainer(),this._miniMapCanvas.addEventListener("wheel",this._preventDefault),this._miniMapCanvas.addEventListener("mousewheel",this._preventDefault),this._update()},_mouseDown:function(e){this._isCursorOverFeature&&(this._isDragging=!0,this._previousPoint=this._currentPoint,this._currentPoint=[e.lngLat.lng,e.lngLat.lat])},_mouseUp:function(){this._isDragging=!1,this._ticking=!1},_mouseMove:function(e){this._ticking=!1;var t=this._miniMap.queryRenderedFeatures(e.point,{layers:["trackingRectFill"]});if((!this._isCursorOverFeature||t.length<=0)&&(this._isCursorOverFeature=t.length>0,this._miniMapCanvas.style.cursor=this._isCursorOverFeature?"move":""),this._isDragging){this._previousPoint=this._currentPoint,this._currentPoint=[e.lngLat.lng,e.lngLat.lat];var a=[this._currentPoint[0]-this._previousPoint[0],this._currentPoint[1]-this._previousPoint[1]],n=this._moveTrackingRect(a);this._parentMap.fitBounds(n,{duration:80,noMoveStart:!0})}},_moveTrackingRect:function(e){var t=this._trackingRect._data.properties.bounds;return t._ne.lng+=e[0],t._ne.lat+=e[1],t._sw.lng+=e[0],t._sw.lat+=e[1],this._convertBoundsToPoints(t),this._trackingRect.setData(this._trackingRect._data),t},_setTrackingRectBounds:function(e){this._convertBoundsToPoints(e),this._trackingRect._data.properties.bounds=e,this._trackingRect.setData(this._trackingRect._data)},_convertBoundsToPoints:function(e){this._trackingRectCoordinates[0][0][0]=e._ne.lng,this._trackingRectCoordinates[0][0][1]=e._ne.lat,this._trackingRectCoordinates[0][1][0]=e._sw.lng,this._trackingRectCoordinates[0][1][1]=e._ne.lat,this._trackingRectCoordinates[0][2][0]=e._sw.lng,this._trackingRectCoordinates[0][2][1]=e._sw.lat,this._trackingRectCoordinates[0][3][0]=e._ne.lng,this._trackingRectCoordinates[0][3][1]=e._sw.lat,this._trackingRectCoordinates[0][4][0]=e._ne.lng,this._trackingRectCoordinates[0][4][1]=e._ne.lat},_update:function(){if(!this._isDragging){var e=this._parentMap.getBounds();this._setTrackingRectBounds(e)}},_zoomAdjust:function(){var e=parseInt(this._parentMap.getZoom());this._miniMap.flyTo({center:this._parentMap.getCenter(),zoom:e<4?0:e-3,bearing:0})}});var Re=Fe,_e="pk.eyJ1IjoiZ2Fydm94IiwiYSI6ImNseHZucnRpcDB4Y3EycXNkNjRuM3drNWsifQ.V5lH9roOpH9a6Jphwybprw",Ue=(a(421),{root:{width:"100%",position:"fixed",top:64,bottom:0}}),Me=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(p.a)(this,Object(u.a)(t).call(this,e))).removeTempLayer=function(){var e=a.state.map.getStyle().layers;a.setState({map:null}),e.map(function(e){return"custom-temp-point"===e.id&&(a.state.map.removeLayer("custom-temp-point"),a.state.map.removeSource("custom-temp-point")),!0}),a.state.popup&&a.state.popup.isOpen()&&a.state.popup.remove()},a.removeAllLayer=function(){var e=a.state.map.getStyle().layers;e.map(function(e){return e.id.includes("-points")&&(a.state.map.removeLayer(e.id),a.state.map.removeSource(e.source)),!0}),e.map(function(e){return e.id.includes("-boundary")&&(a.state.map.removeLayer(e.id),a.state.map.removeSource(e.source)),!0}),a.state.popup&&a.state.popup.isOpen()&&a.state.popup.remove(),f.emit("handleDatasetRemove")},a.add3dLayer=function(){var e=a.state.map.getStyle().layers;for(var t in e)if("symbol"===t.type&&t.layout["text-field"]){var n=t.id;break}a.state.map.getLayer("3d-buildings")?a.state.map.moveLayer("3d-buildings",n):a.state.map.addLayer({id:"3d-buildings",source:"composite","source-layer":"building",filter:["==","extrude","true"],type:"fill-extrusion",minzoom:12,paint:{"fill-extrusion-color":"#aaa","fill-extrusion-height":["interpolate",["linear"],["zoom"],15,0,15.05,["get","height"]],"fill-extrusion-base":["interpolate",["linear"],["zoom"],15,0,15.05,["get","min_height"]],"fill-extrusion-opacity":.6}},n)},a.removeTempPoint=function(){a.state.draw.delete(a.state.tempId),a.setState({tempId:null})},a.splitAssetName=function(e){var t=e.split("/"),a=t[t.length-1];return a.startsWith("0")&&(a=a.substring(1)),a},a.handleURLMoved=function(e){console.log("Received moved data:",e),a.setState({url:e[0]}),console.log(e[2]),f.emit("newLayer",{id:e[2],url:e[0],visible:!0,transparency:100}),console.log(e),f.emit("showSnackbar","success","The layer '".concat(a.splitAssetName(e[2]),"' has been loaded")),a.state.map.addLayer({id:e[2],type:"raster",source:{type:"raster",tiles:[a.state.url],tileSize:256},paint:{"raster-opacity":.8}});var t=e[3];t&&"Polygon"===t.type?a.flyToGeometry(a.state.map,t):console.error("Invalid GeoJSON Polygon in movedURL[3]"),console.log(a.state.url)},a.mapContainer=o.a.createRef(),a.state={map:null,draw:null,minimap:null,popup:null,gettingPoint:null,tempId:null,styleCode:Object.values(ue)[1].substring(16),accessGranted:!1,points:[]},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"flyToGeometry",value:function(e,t){var a,n=t.type;(console.log(t),"FeatureCollection"===n)?a=t.features[0].geometry.coordinates:a="Feature"===n?t.geometry.coordinates:t.coordinates;"Polygon"===t.type?(console.log(a[0][0]),console.log(a[0][0][1],a[0][0][0]),this.state.map.flyTo({center:[a[0][0][0],a[0][0][1]],zoom:15})):"Point"===t.type&&this.state.map.flyTo({center:[a[0][0],a[0][1]],zoom:17})}},{key:"componentDidMount",value:function(){var e=this;if(Be.a.accessToken=_e,Be.a.supported()){var t=new Be.a.Map({container:this.mapContainer.current,style:Object.values(ue)[0],center:[-4.835985,37.701896],zoom:7,antialias:!0});this.state.points.forEach(function(e){var a=document.createElement("div");a.className="marker",a.style.width="20px",a.style.height="20px",a.style.backgroundColor="#ff4081",a.style.borderRadius="50%",a.style.cursor="pointer",a.addEventListener("click",function(){var t=document.createElement("a");t.href=e.file,t.download=e.id+".pdf",console.log(t),t.click()}),new Be.a.Marker(a).setLngLat(e.coordinates).addTo(t)});var a=new Le.a({controls:{combine_features:!1,uncombine_features:!1}}),n=new Re({center:t.getCenter(),style:Object.values(ue)[0]});t.addControl(new Oe.a({accessToken:Be.a.accessToken,mapboxgl:Be.a,localGeocoder:je,placeholder:"Search Address",marker:{color:"red"}}),"top-left"),t.addControl(new Be.a.NavigationControl,"top-left"),t.addControl(new Be.a.GeolocateControl,"top-left"),t.addControl(new Te.a({trafficSource:new RegExp("/*/")}),"top-left"),t.addControl(a,"top-left"),t.addControl(n,"bottom-left");var o=new Be.a.Popup({closeButton:!1,anchor:"bottom"}).setHTML('<div id="popup-container"></div>');document.getElementsByClassName("mapboxgl-ctrl-geocoder--input")[0].setAttribute("type","search-box"),t.on("load",function(){e.add3dLayer(),document.getElementById("loader-wrapper").classList.add("loaded")}),t.on("zoomend",function(){var e=t.getZoom();f.emit("setMapZoom",e)}),t.on("draw.create",function(t){e.state.gettingPoint&&(e.setState({tempId:t.features[0].id}),f.emit("setPoint",t.features[0],e.state.styleCode,e.state.map.getZoom()),e.setState({gettingPoint:!1}))}),this.setMapStyleListener=f.addListener("setMapStyle",function(t){e.state.popup.isOpen()&&e.state.popup.remove();var a=Object(ve.a)({},e.state.map.getStyle().sources),n=Object(ge.a)(e.state.map.getStyle().layers);console.log(a),console.log(n),e.state.map.setStyle(ue[t]),e.state.map.on("style.load",function(){Object.keys(a).forEach(function(t){if(e.state.map.getSource(t))console.log('Source with id "'.concat(t,'" already exists'));else try{e.state.map.addSource(t,a[t])}catch(n){console.error("Error adding source ".concat(t,":"),n)}}),n.forEach(function(t){if(e.state.map.getLayer(t.id))console.log('Layer with id "'.concat(t.id,'" already exists'));else try{e.state.map.addLayer(t)}catch(a){console.error("Error adding layer ".concat(t.id,":"),a)}})});var o=new Re({center:e.state.map.getCenter(),style:ue[t]});e.state.map.removeControl(e.state.minimap),e.state.map.addControl(o,"bottom-left"),e.setState({minimap:o,styleCode:ue[t].substring(16)})}),this.toggleLayerVisibilityListener=f.addListener("toggleLayerVisibility",function(t,a){e.state.map.getLayer(t)&&e.state.map.setLayoutProperty(t,"visibility",a?"visible":"none")}),this.changeLayerTransparencyListener=f.addListener("changeLayerTransparency",function(t,a){e.state.map.getLayer(t)&&e.state.map.setPaintProperty(t,"raster-opacity",a)}),this.displayDatasetListener=f.addListener("displayDataset",function(a,n){e.state.map.getSource(a)&&e.state.map.removeSource(a),t.addSource(a,{type:"geojson",data:n}),t.addLayer({id:a+"-boundary",type:"fill",source:a,paint:{"fill-color":"#888888","fill-opacity":.4},filter:["==","$type","Polygon"]}),t.addLayer({id:a+"-points",type:"circle",source:a,paint:{"circle-radius":6,"circle-color":"#B42222"},filter:["==","$type","Point"]}),e.flyToGeometry(t,n)}),this.removeDatasetListener=f.addListener("removeDataset",function(t){[t+"-boundary",t+"-points"].forEach(function(t){e.state.map.getLayer(t)&&e.state.map.removeLayer(t)}),e.state.map.getSource(t)&&e.state.map.removeSource(t)}),this.displayTempLayerListener=f.addListener("displayTempLayer",function(t){e.removeTempLayer(),e.state.map.hasImage("marker")||e.state.map.addImage("marker",Ae,{pixelRatio:3}),e.state.map.addLayer({id:"custom-temp-point",type:"symbol",source:{type:"geojson",data:t.geometry},layout:{"icon-image":"marker"}}),e.state.popup.setLngLat(t.geometry.geometry.coordinates).addTo(e.state.map),f.emit("bindPopup",t),e.state.map.flyTo({center:t.geometry.geometry.coordinates,zoom:6,bearing:0})}),this.setState({map:t,draw:a,minimap:n,popup:o}),f.on("moveURL",this.handleURLMoved)}else alert("Your browser does not support Mapbox GL")}},{key:"componentWillUnmount",value:function(){f.removeListener(this.setMapStyleListener),f.removeListener(this.displayDatasetListener),f.removeListener(this.removeDatasetListener),f.removeListener(this.displayTempLayerListener),f.removeListener(this.toggleLayerVisibilityListener),f.removeListener(this.changeLayerTransparencyListener)}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("div",{id:"map",style:Ue.root,ref:this.mapContainer}))}}]),t}(o.a.Component),We=a(558),Ne={root:{minWidth:320,maxWidth:345},image:{height:140},titleContainer:{display:"flex",alignItems:"space-between",padding:"5px 16px 2px"},titleContainerEnd:{display:"flex",alignItems:"space-between",padding:"5px 16px 10px"},nameContainer:{display:"flex",flexDirection:"column",justifyContent:"flex-end",height:65},popupName:{display:"inline-block"},popupPinyin:{display:"inline-block"},weatherWidgetContainer:{position:"absolute",right:0,width:155},introductionContainer:{paddingTop:5},popupIntroduction:{wordWrap:"break-word",wordBreak:"break-all"}},ze=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={open:!1,data:{}},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.bindPopupListener=f.addListener("bindPopup",function(t){var a=document.getElementById("popup");document.getElementById("popup-container").appendChild(a);var n=document.createElement("script");n.type="text/javascript",n.src="https://darksky.net/widget/default-small/".concat(t.geometry.geometry.coordinates[1].toString(),",").concat(t.geometry.geometry.coordinates[0].toString(),"/ca12/en.js?height=60"),document.getElementById("customize-script-container").appendChild(n),e.setState({open:!0,data:t})})}},{key:"componentWillUnmount",value:function(){f.removeListener(this.bindPopupListener)}},{key:"render",value:function(){return o.a.createElement(ce.a,{id:"popup",style:Ne.root,className:this.state.open?null:"hidden"},o.a.createElement(We.a,{className:this.state.data.image&&this.state.data.image.src?null:"hidden",style:Ne.image,image:this.state.data.image&&this.state.data.image.src?this.state.data.image.src:"#"}),o.a.createElement(de.a,{style:this.state.data.introduction?Ne.titleContainer:Ne.titleContainerEnd},o.a.createElement("div",{style:Ne.nameContainer},o.a.createElement($.a,{style:Ne.popupName,variant:"h5",component:"h2"},this.state.data.name),o.a.createElement($.a,{style:Ne.popupPinyin,variant:"subtitle1",color:"textSecondary",component:"h3"},this.state.data.pinyin)),o.a.createElement("div",{id:"customize-script-container",style:Ne.weatherWidgetContainer})),o.a.createElement(de.a,{style:Ne.introductionContainer,className:this.state.data.introduction?null:"hidden"},o.a.createElement($.a,{style:Ne.popupIntroduction,variant:"body2",color:"textSecondary",component:"p"},this.state.data.introduction)))}}]),t}(o.a.Component),He=(a(422),a(12)),Ve=(a(92),a(236)),qe=a(458),Ge=a(559),Ze=a(560),Je=a(561),Ye=a(562),$e=a(129),Ke=a(590),Qe=a(564),Xe=a(563),et=a(139),tt=a.n(et),at=a(276),nt=Object(Ve.a)(function(e){return{root:{width:"100%","& .MuiDropzoneArea-root":{minHeight:"100px",maxHeight:"200px"}},fileDetails:{marginTop:e.spacing(1)},heading:{fontSize:e.typography.pxToRem(15),flexBasis:"33.33%",flexShrink:0,fontWeight:"bold"},secondaryHeading:{fontSize:e.typography.pxToRem(15),color:e.palette.text.secondary},checkBoxContainer:{display:"flex",flexDirection:"row",justifyContent:"center",flexWrap:"wrap"},formControl:{margin:e.spacing(1),minWidth:120,width:"100%"},inputLabel:{marginBottom:e.spacing(1)},dateInput:{width:"100%",marginTop:e.spacing(2),marginBottom:e.spacing(2)},foormControl:{margin:e.spacing(3)},dropzone:{minHeight:"191px"},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},progressText:{marginLeft:e.spacing(2)}}});function ot(e){var t=e.onSubmit,a=nt(),r=Object(n.useState)([]),i=Object(He.a)(r,2)[1],l=Object(n.useState)("rf"),s=Object(He.a)(l,2)[1],c=Object(n.useState)(!1),d=Object(He.a)(c,2),p=d[0],u=d[1],m=Object(n.useState)({rf:!1,svm:!1,knn:!1,aoiDataFiles:[],startDate:"2000-04-14",endDate:"2024-05-14",satelliteData:{sentinel1:!1,sentinel2:!1,landsat:!1},indexes:{vegetationIndexes:!1,brightnessIndexes:!1,moistureIndexes:!1},modelFeatures:{numberOfTrees:500,seed:1e-4,bagFraction:0},performanceIndicators:{rsquare:!1,rmse:!1,mse:!1,mae:!1,rpiq:!1}}),h=Object(He.a)(m,2),v=h[0],y=h[1],b=Object(n.useState)(!1),x=Object(He.a)(b,2),C=x[0],E=x[1],S=Object(n.useState)(0),w=Object(He.a)(S,2),k=w[0],L=w[1];Object(n.useEffect)(function(){var e;return C?e=setInterval(function(){L(function(e){return e+1})},1e3):clearInterval(e),function(){return clearInterval(e)}},[C]);var I=function(e){return function(t,a){u(!!a&&e)}},O=function(e){var t=e.target,a=t.name,n=t.value,o=t.checked,r=t.type;y(function(e){return Object(ve.a)({},e,Object(fe.a)({},a,"checkbox"===r||"radio"===r?o:n))}),"options"===a&&s(n)},D=function(){var e=Object(z.a)(N.a.mark(function e(){var a,n,o,r,i,l,s;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n in e.prev=0,E(!0),L(0),a=new FormData,console.log(v.endDate),a.append("aoiDataFiles",v.aoiDataFiles[0]),a.append("startDate",v.startDate),a.append("endDate",v.endDate),console.log(v),v.satelliteData)a.append(n,v.satelliteData[n]);for(o in v.indexes)a.append(o,v.indexes[o]);for(r in v.modelFeatures)a.append(r,v.modelFeatures[r]);for(i in v.performanceIndicators)a.append(i,v.performanceIndicators[i]);return console.log(a),e.next=16,fetch("http://localhost:5004/api/rusle",{method:"POST",body:a});case 16:return l=e.sent,e.next=19,l.json();case 19:(s=e.sent)&&(console.log("Data sent successfully",s),t(s.output),E(!1),f.emit("closeAllController"),f.emit("openLayerController")),e.next=28;break;case 23:e.prev=23,e.t0=e.catch(0),E(!1),f.emit("showSnackbar","error","Error: '".concat(e.t0,"'")),console.error("Failed to send data",e.t0);case 28:case"end":return e.stop()}},e,null,[[0,23]])}));return function(){return e.apply(this,arguments)}}();return o.a.createElement("div",{className:a.root},o.a.createElement(Ke.a,{expanded:"panel2"===p,onChange:I("panel2")},o.a.createElement(Xe.a,{expandIcon:o.a.createElement(tt.a,null),"aria-controls":"panel2bh-content",id:"panel2bh-header"},o.a.createElement($.a,{className:a.heading},"Upload Files")),o.a.createElement(Qe.a,null,o.a.createElement($e.a,{onChange:function(e){return function(e,t){if(t&&t.length>0){var a=new FileReader;a.onload=function(){var e=Object(z.a)(N.a.mark(function e(t){var a,n,o;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(at.a)(t.target.result);case 3:a=e.sent,n=a.features.length>0?Object.keys(a.features[0].properties):[],o=n.filter(function(e){return"number"===typeof a.features[0].properties[e]}),i(o),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Error processing shapefile",e.t0);case 12:case"end":return e.stop()}},e,null,[[0,9]])}));return function(t){return e.apply(this,arguments)}}(),a.readAsArrayBuffer(t[0])}y(function(a){return Object(ve.a)({},a,Object(fe.a)({},e,t))})}("aoiDataFiles",e)},acceptedFiles:[".zip"],dropzoneText:"Area of Interest",maxFileSize:5e6,filesLimit:1,getPreviewIcon:function(e,t){var a=e.file.type,n={className:t.image};if(a.startsWith("video/"))return o.a.createElement(Ge.a,n);switch(a){case"application/msword":case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":return o.a.createElement(Ze.a,n);case"application/pdf":return o.a.createElement(Je.a,n);default:return o.a.createElement(Ye.a,n)}}}))),o.a.createElement(Ke.a,{expanded:"panel3"===p,onChange:I("panel3")},o.a.createElement(Xe.a,{expandIcon:o.a.createElement(tt.a,null),"aria-controls":"panel3bh-content",id:"panel3bh-header"},o.a.createElement($.a,{className:a.heading},"Dates")),o.a.createElement(Qe.a,null,o.a.createElement(pe.a,{container:!0,spacing:2},o.a.createElement(pe.a,{item:!0,xs:12,sm:10},o.a.createElement(Y.a,{label:"Start Date",type:"date",name:"startDate",value:v.startDate,onChange:O,className:a.dateInput,InputLabelProps:{shrink:!0}}),o.a.createElement(Y.a,{label:"End Date",type:"date",name:"endDate",value:v.endDate,onChange:O,className:a.dateInput,InputLabelProps:{shrink:!0}}))))),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement(g.a,{onClick:D,color:"primary",variant:"contained"},"Submit Data"),o.a.createElement(qe.a,{className:a.backdrop,open:C},o.a.createElement(G.a,{color:"inherit"}),o.a.createElement($.a,{variant:"h6",className:a.progressText},"Loading... ",k,"s")))}var rt=Object(O.b)({palette:{primary:{main:Q.a.A200}}}),it={root:{position:"fixed",top:74,right:10,borderRadius:9,minWidth:350,margin:0,zIndex:900,boxShadow:"-6px 6px 15px rgba(0, 0, 0, 0.15)"},rooot:{width:"100%"},content:{paddingBottom:16},heading:{fontSize:rt.typography.pxToRem(15),flexBasis:"33.33%",flexShrink:0},secondaryHeading:{fontSize:rt.typography.pxToRem(15),color:rt.palette.text.secondary},header:{backgroundColor:"rgba(76,175,80,255)"},closeBtn:{position:"absolute",top:6,right:8,fontSize:22},searchField:{display:"flex",alignItems:"center",width:"100%",height:40,padding:"2px 4px"},searchBox:{marginLeft:8,flex:1,border:"none !important"},searchBoxBtn:{padding:8},searchOptionsContainer:{padding:"5px 2px"},searchOption:{color:"rgba(0, 0, 0, 0.6)",cursor:"pointer"},searchBoxProgress:{marginRight:8},searchBoxDivider:{width:1,height:28,margin:4},resultWrapperOpen:{maxWidth:800},resultWrapperClosed:{maxWidth:350},resultContainer:{paddingTop:0,paddingBottom:0},resultTable:{boxShadow:"none"},uploadBoxInput:{display:"none"},uploadBoxBtnEdit:{width:40,height:40,lineHeight:"40px",textAlign:"center",borderRadius:"50%",fontSize:22},wrapBtn:{position:"absolute",bottom:12,left:18,padding:10,fontSize:24},addPointWrapperOpen:{maxWidth:350},addPointWrapperClose:{width:0},uploadBoxBtnAdd:{width:90,height:90,lineHeight:"90px",textAlign:"center",borderRadius:"50%",fontSize:30,backgroundColor:"rgba(0, 0, 0, 0.08)"},previewImageContainer:{display:"flex",alignItems:"center"},nameTextField:{margin:"0 20px 0 13px"},pinyinTextField:{margin:"10px 20px 10px 13px"},introTextField:{width:"100%",marginTop:5},locationImageContainer:{display:"flex",flexDirection:"column",alignItems:"center"},locationImage:{display:"block",marginTop:5,width:225,height:140,borderRadius:3,cursor:"pointer"},locationLabel:{display:"block",marginTop:6},actions:{paddingTop:10},saveBtn:{display:"inline-block",position:"relative",marginRight:10},saveBtnProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}},lt=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={open:!1,resultUnwrap:!1,addPointUnwrap:!1,optionsOpen:!1,searching:!1,submitting:!1,anchorEl:null,geometry:null,previewImage:null,previewMapUrl:null,previewCoordinate:{},loading:!0,traces:[],items:[{id:1,title:"item #1"},{id:2,title:"item #2"},{id:3,title:"item #3"},{id:4,title:"item #4"},{id:5,title:"item #5"}],data:[],expanded:!1},a.calculateSustainabilityIndex=function(){var e=1===a.state.Io?a.state.IoType:0,t=2.45*a.state.Ic+2.18*a.state.Ih+1.64*a.state.Ig+1.09*e+1*a.state.If;a.setState({sustainabilityIndex:t})},a.handleDecision=function(e){a.setState({decision:e})},a.initMaterialbox=function(){var e=document.querySelectorAll(".materialboxed");x.a.Materialbox.init(e,{onOpenStart:function(e){e.parentNode.style.overflow="visible"},onCloseEnd:function(e){e.parentNode.style.overflow="hidden"}})},a.resetPreviewImage=function(){a.setState({previewImage:null})},a.resetNewPointData=function(){a.setState({previewMapUrl:null,geometry:null,previewCoordinate:{}})},a.handleCloseClick=function(){a.setState({open:!1})},a.handleDataSubmit=function(e){a.setState({url:e}),console.log("Datos recibidos en ModelController:",e),f.emit("moveURL",a.state.url)},a.handleAddClick=function(){f.emit("getPoint"),a.handleWrapClick(),a.resetPreviewImage(),a.resetNewPointData(),a.setState({addPointUnwrap:!1})},a.handleWrapClick=function(){f.emit("removeTempLayer"),a.resetPreviewImage(),document.getElementById("search-box").value="",a.setState({resultUnwrap:!1})},a.handleImageChange=function(e){e.target.files[0]&&(e.target.files[0].size>1048576?f.emit("showSnackbar","error","Error: Image must be smaller than 1MB."):a.state.reader.readAsDataURL(e.target.files[0]))},a.handleDoneEdit=function(){a.resetPreviewImage(),setTimeout(a.initMaterialbox,800)},a.handleSearchOptionsClick=function(){a.setState({optionsOpen:!0})},a.handleSearchOptionsClose=function(){a.setState({optionsOpen:!1})},a.handleSearchOptionChange=function(e){var t=null,n=!1;if(a.state.searchOptions.map(function(a){return a.value===e.currentTarget.value&&(a.checked=e.currentTarget.checked,t=a),n=n||a.checked,!0}),!n)return f.emit("showSnackbar","error","Error: Please select at least one option."),void(t.checked=!0);a.setState({searchOptions:a.state.searchOptions})},a.handleSearchClick=function(){if(a.handleCancelClick(),document.getElementById("search-box").value){a.setState({searching:!0});var e={};a.state.searchOptions.map(function(t){return e[t.value]=t.checked,!0})}},a.handlePreviewClick=function(e,t){f.emit("displayTempLayer",t)},a.handlePreviewMapClick=function(){f.emit("getPoint"),a.setState({addPointUnwrap:!1})},a.handleSelectChange=function(e){a.setState(Object(fe.a)({},e.target.name,Number(e.target.value)))},a.handleCancelClick=function(){f.emit("removeTempPoint"),document.getElementById("name").value="",document.getElementById("pinyin").value="",document.getElementById("introduction").value="",a.resetPreviewImage(),a.resetNewPointData(),a.setState({addPointUnwrap:!1})},a.moveURL=function(){var e=a.state.url;a.setState({movedURL:e}),console.log(a.state.movedURL)},a.processTemperatureData=function(e){var t={type:"scatter",mode:"lines",x:e.map(function(e){return new Date(e.sampling_date)}),y:e.map(function(e){return e.measurement_value}),name:"Temperatura del Aire HC"};a.setState({temperatureData:[t],loading:!1})},a.processPrecipitationData=function(e){var t={type:"scatter",mode:"lines",x:e.map(function(e){return new Date(e.sampling_date)}),y:e.map(function(e){return e.measurement_value}),name:"Precipitaci\xf3n"};a.setState({precipitationData:[t],loading:!1})},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=document.getElementById("anchorEl"),a=new FileReader;a.onload=function(t){var a=new Image;a.src=t.target.result;var n={longitude:a.height>a.width,src:t.target.result};e.setState({previewImage:n})},this.setState({reader:a,anchorEl:t}),this.openRusleControllerListener=f.addListener("openRusleController",function(){e.setState({open:!0})}),this.closeAllControllerListener=f.addListener("closeAllController",function(){e.setState({open:!1})}),this.updatePointListener=f.addListener("setPoint",function(t,a,n){var o=Object(He.a)(t.geometry.coordinates,2),r=o[0],i=o[1],l="https://api.mapbox.com/styles/v1/".concat(a,"/static/pin-s+f00(").concat(r,",").concat(i,")/").concat(r,",").concat(i,",").concat(n,",0,1/250x155@2x?access_token=").concat(_e);e.setState({addPointUnwrap:!0,previewMapUrl:l,geometry:t,previewCoordinate:{lng:parseFloat(r).toFixed(3),lat:parseFloat(i).toFixed(3)}})}),this.moveURListener=f.addListener("moveURL",function(){e.moveURL()})}},{key:"setIc",value:function(e){this.setState({Ic:e})}},{key:"setIh",value:function(e){this.setState({Ih:e})}},{key:"setIg",value:function(e){this.setState({Ig:e})}},{key:"setIo",value:function(e){this.setState({Io:e})}},{key:"setIoType",value:function(e){this.setState({IoType:e})}},{key:"setIf",value:function(e){this.setState({If:e})}},{key:"componentWillUnmount",value:function(){f.removeListener(this.openRusleControllerListener),f.removeListener(this.closeAllControllerListener),f.removeListener(this.addPointListener),f.removeListener(this.updatePointListener),f.removeListener(this.moveURListener),document.querySelectorAll(".materialboxed").map(function(e){return e.destory()})}},{key:"render",value:function(){return o.a.createElement(D.a,{theme:rt},o.a.createElement(J.a,{direction:"left",in:this.state.open},o.a.createElement(ce.a,{style:it.root},o.a.createElement(de.a,{style:it.header},o.a.createElement($.a,{gutterBottom:!0,variant:"h5",component:"h2",style:{fontFamily:"Lato, Arial, sans-serif",color:"white",fontWeight:"3"}},"Soil Erosion Modelling"),o.a.createElement($.a,{variant:"body2",color:"textSecondary"},"Upload your shape and map the erosion model result")),o.a.createElement(de.a,{style:it.content},o.a.createElement(ot,{onSubmit:this.handleDataSubmit}),o.a.createElement(L.a,{style:it.closeBtn,"aria-label":"Close",onClick:this.handleCloseClick},o.a.createElement(I.a,{fontSize:"inherit"},"chevron_right"))))))}}]),t}(o.a.Component),st=a(551),ct=a(603),dt=a(580),pt=a(565),ut=Object(O.b)({typography:{fontFamily:"Lato, Arial, sans-serif"},overrides:{MuiCssBaseline:{"@global":{body:{fontFamily:"Lato, Arial, sans-serif"}}}}}),mt={root:{position:"fixed",top:74,right:10,width:300,borderRadius:9,margin:0,zIndex:900,boxShadow:"-6px 6px 15px rgba(0, 0, 0, 0.15)"},header:{backgroundColor:"rgb(138, 213, 137)"},closeBtn:{position:"absolute",top:6,right:8,fontSize:22},content:{paddingBottom:16},select:{width:"100%"}},ht=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={open:!1,assets:[],selectedSpecies:"",selectedAsset:"",speciesOptions:[],filteredAssets:[]},a.fetchAssets=Object(z.a)(N.a.mark(function e(){var t,n,o,r;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost:5004/api/list-assets");case 3:return t=e.sent,e.next=6,t.json();case 6:n=e.sent,o=n.assets,r=a.getSpeciesOptions(o),console.log(o),a.setState({assets:o,speciesOptions:r}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.error("Error fetching assets:",e.t0);case 16:case"end":return e.stop()}},e,null,[[0,13]])})),a.splitAssetName=function(e){var t=e.split("/"),a=t[t.length-1];return a.startsWith("0")&&(a=a.substring(1)),a},a.getSpeciesOptions=function(e){var t=new Set;return e.forEach(function(e){var a=e.id;if(a.includes("_avg")){var n=a.split("_")[0]+"_"+a.split("_")[1];t.add(n)}else t.add("Others")}),Array.from(t)},a.handleSpeciesChange=function(e){var t=e.target.value;a.setState({selectedSpecies:t}),a.filterAssetsBySpecies(t)},a.filterAssetsBySpecies=function(e){var t;t="Others"===e?a.state.assets.filter(function(e){return!e.id.includes("_avg")}):a.state.assets.filter(function(t){return a.splitAssetName(t.id).includes(e)}),a.setState({filteredAssets:t})},a.handleAssetChange=function(e){var t=e.target.value.id,n=e.target.value.type;a.setState({selectedAsset:t,selectedAssetType:n}),a.fetchMapUrl(t,n)},a.parseLayerName=function(e){if(console.log(e),e.endsWith("_avg")){var t=e.split("_");if(console.log(t),3===t.length)return"Current";if(5===t.length){var a=t[2],n="20"+t[3];return"RCP".concat(a," ").concat(n)}}return e},a.fetchMapUrl=function(){var e=Object(z.a)(N.a.mark(function e(t,n){var o,r;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost:5004/api/get-map-url",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({asset_id:t,asset_type:n})});case 3:return o=e.sent,e.next=6,o.json();case 6:r=e.sent,a.setState({mapUrl:r.map_url}),f.emit("moveURL",r.map_url),f.emit("closeAllController"),f.emit("openLayerController"),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.error("Error fetching map URL:",e.t0);case 16:case"end":return e.stop()}},e,null,[[0,13]])}));return function(t,a){return e.apply(this,arguments)}}(),a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.fetchAssets(),this.openBushEncroacherControllerListener=f.addListener("openBushEncoracherController",function(){e.setState({open:!0})}),this.closeAllControllerListener=f.addListener("closeAllController",function(){e.setState({open:!1})})}},{key:"componentWillUnmount",value:function(){f.removeListener(this.openBushEncroacherControllerListener),f.removeListener(this.closeAllControllerListener),f.removeListener(this.setMapZoomListener),f.removeListener(this.handleDatasetRemoveListener)}},{key:"render",value:function(){var e=this;return o.a.createElement(D.a,{theme:ut},o.a.createElement(J.a,{direction:"left",in:this.state.open},o.a.createElement(ce.a,{style:mt.root},o.a.createElement(de.a,{style:mt.header},o.a.createElement($.a,{gutterBottom:!0,style:{fontFamily:"Lato, Arial, sans-serif",color:"white",fontWeight:"3"},variant:"h5",component:"h2"},"Visualizador de capas"),o.a.createElement($.a,{variant:"body2",color:"textSecondary"},"Visualiza diferentes capas"),o.a.createElement(L.a,{style:mt.closeBtn,"aria-label":"Close",onClick:function(){return e.setState({open:!1})}},o.a.createElement(I.a,{fontSize:"inherit"},"chevron_right"))),o.a.createElement(de.a,{style:mt.content},o.a.createElement(st.a,{style:mt.select},o.a.createElement(ct.a,null,"Tipo"),o.a.createElement(dt.a,{value:this.state.selectedSpecies,onChange:this.handleSpeciesChange},this.state.speciesOptions.map(function(t){return o.a.createElement(pt.a,{key:e.splitAssetName(t),value:e.splitAssetName(t)},e.splitAssetName(t).replace("_"," "))}))),o.a.createElement(st.a,{style:mt.select,disabled:!this.state.selectedSpecies},o.a.createElement(ct.a,null,"Capa a visualiz."),o.a.createElement(dt.a,{value:this.state.selectedAsset,onChange:this.handleAssetChange},this.state.filteredAssets.map(function(t){return o.a.createElement(pt.a,{key:t.id,value:{id:t.id,type:t.type}},e.parseLayerName(e.splitAssetName(t.id)).replace("_"," "))})))))))}}]),t}(o.a.Component),gt=a(277),ft=a(583),vt=a(599),yt=a(600),bt=a(579),xt=a(591),Ct=a(191),Et=a(593);var St=function(e){var t=e.data,a=e.onBack;return o.a.createElement("div",null,o.a.createElement(xt.a,{onClick:a,variant:"outlined",style:{margin:"20px"}},"Back to Search"),o.a.createElement(vt.a,{style:{margin:"20px"}},o.a.createElement(yt.a,null,o.a.createElement(Ct.a,{variant:"h5",component:"div"},"Informaci\xf3n de la Parcela"),o.a.createElement("div",{style:{maxHeight:300,overflowY:"auto"}},o.a.createElement(Ct.a,{variant:"subtitle1",color:"textSecondary"},"Provincia: ",t.parcelaInfo.provincia||"No existe informaci\xf3n en SIGPAC sobre esto"),o.a.createElement(Ct.a,{variant:"subtitle1",color:"textSecondary"},"Municipio: ",t.parcelaInfo.municipio||"No existe informaci\xf3n en SIGPAC sobre esto"),o.a.createElement(Ct.a,{variant:"subtitle1",color:"textSecondary"},"Pol\xedgono: ",t.parcelaInfo.poligono,", Parcela: ",t.parcelaInfo.parcela||"No existe informaci\xf3n en SIGPAC sobre esto"),o.a.createElement(Ct.a,{variant:"subtitle1",color:"textSecondary"},"Superficie: ",t.parcelaInfo.dn_surface?"".concat(t.parcelaInfo.dn_surface.toFixed(2)," m\xb2"):"No existe informaci\xf3n en SIGPAC sobre esto"),o.a.createElement(Ct.a,{variant:"subtitle1",color:"textSecondary"},"Referencia Catastral: ",t.parcelaInfo.referencia_cat||"No existe informaci\xf3n en SIGPAC sobre esto"),o.a.createElement(Ct.a,{variant:"h6",component:"div",style:{marginTop:"20px"}},"Detalles Adicionales"),o.a.createElement(Et.a,{container:!0,spacing:2},t.query&&t.query.length>0?t.query.map(function(e,t){return o.a.createElement(Et.a,{item:!0,xs:12,sm:6,key:t},o.a.createElement(vt.a,{variant:"outlined"},o.a.createElement(yt.a,null,o.a.createElement(Ct.a,{variant:"body2"},"Uso: ",e.uso_sigpac||"No disponible"),o.a.createElement(Ct.a,{variant:"body2"},"Incidencias: ",e.incidencias||"No disponible"," - ",e.inctexto?e.inctexto.join(", "):"No disponible"),o.a.createElement(Ct.a,{variant:"body2"},"Altitud: ",e.altitud||"No disponible"," metros"),o.a.createElement(Ct.a,{variant:"body2"},"Pendiente Media: ",e.pendiente_media||"No disponible","%"))))}):o.a.createElement(Ct.a,{style:{marginLeft:"20px"}},"No existen detalles adicionales disponibles.")),o.a.createElement(Ct.a,{variant:"h6",component:"div",style:{marginTop:"20px"}},"\xc1rboles en la Parcela"),t.arboles&&t.arboles.length>0?o.a.createElement(o.a.Fragment,null,t.arboles.map(function(e,t){return o.a.createElement(Ct.a,{variant:"body2",key:t},function(e){var t=Object.entries(e).filter(function(e){var t=Object(He.a)(e,2),a=t[0],n=t[1];return"recinto"!==a&&"total"!==a&&n>0});return 0===t.length?"No existen datos de \xe1rboles disponibles.":t.map(function(e){var t=Object(He.a)(e,2),a=t[0],n=t[1];return"".concat(a.charAt(0).toUpperCase()+a.slice(1),": ").concat(n)}).join(", ")}(e))})):o.a.createElement(Ct.a,{style:{marginLeft:"20px"}},"No existen datos de \xe1rboles disponibles."),o.a.createElement(Ct.a,{variant:"body2",style:{marginTop:"20px"}},"\xdaltima Convergencia: ",t.convergencia&&t.convergencia.cat_fechaultimaconv?new Date(t.convergencia.cat_fechaultimaconv).toLocaleDateString():"No disponible"),o.a.createElement(Ct.a,{variant:"body2"},"Fecha del Vuelo: ",t.vuelo&&t.vuelo.fecha_vuelo||"No disponible")))))};var wt=function(e){var t=e.onSubmit,a=Object(n.useState)(""),r=Object(He.a)(a,2),i=r[0],l=r[1],s=Object(n.useState)(""),c=Object(He.a)(s,2),d=c[0],p=c[1],u=Object(n.useState)(""),m=Object(He.a)(u,2),h=m[0],g=m[1],f=Object(n.useState)(""),v=Object(He.a)(f,2),y=v[0],b=v[1],x=Object(n.useState)(""),C=Object(He.a)(x,2),E=C[0],S=C[1],w=Object(n.useState)(null),k=Object(He.a)(w,2),L=k[0],I=k[1],O=Object(n.useState)(!1),D=Object(He.a)(O,2),T=D[0],P=D[1],B=Object(n.useState)(!1),j=Object(He.a)(B,2),A=j[0],F=j[1],R=function(){var e=Object(z.a)(N.a.mark(function e(){var a,n,o,r,l,s,c,p,u;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return P(!0),a=d.padStart(2,"0"),n=h.padStart(3,"0"),o=y.padStart(3,"0"),r=i.padStart(5,"0"),l="".concat(a).concat(n,"A").concat(o).concat(r),s="http://localhost:5004/cadastral/".concat(l),c="?recintoNum=".concat(E),e.prev=8,e.next=11,fetch("".concat(s).concat(c));case 11:return p=e.sent,e.next=14,p.json();case 14:u=e.sent,console.log(u),t(u.output),I(u.parcelInfo),F(!0),e.next=25;break;case 21:e.prev=21,e.t0=e.catch(8),console.error("Error fetching data: ",e.t0),I({error:"Failed to fetch data"});case 25:P(!1);case 26:case"end":return e.stop()}},e,null,[[8,21]])}));return function(){return e.apply(this,arguments)}}();return o.a.createElement("div",null,A?o.a.createElement(St,{data:L,onBack:function(){F(!1)}}):o.a.createElement(vt.a,{style:{maxWidth:500,margin:"20px auto"}},o.a.createElement(yt.a,null,o.a.createElement(bt.a,{fullWidth:!0,label:"Provincia",variant:"outlined",value:d,onChange:function(e){return p(e.target.value)},style:{marginBottom:16}}),o.a.createElement(bt.a,{fullWidth:!0,label:"Municipio",variant:"outlined",value:h,onChange:function(e){return g(e.target.value)},style:{marginBottom:16}}),o.a.createElement(bt.a,{fullWidth:!0,label:"Pol\xedgono",variant:"outlined",value:y,onChange:function(e){return b(e.target.value)},style:{marginBottom:16}}),o.a.createElement(bt.a,{fullWidth:!0,label:"Parcela",variant:"outlined",value:i,onChange:function(e){return l(e.target.value)},style:{marginBottom:16}}),o.a.createElement(bt.a,{fullWidth:!0,label:"N\xfamero del Recinto",variant:"outlined",value:E,onChange:function(e){return S(e.target.value)},style:{marginBottom:16}}),o.a.createElement(xt.a,{variant:"contained",color:"primary",onClick:R,disabled:T},"Submit"))))},kt=a(571),Lt=Object(gt.a)({palette:{primary:{main:Q.a.A200}}}),It={root:{position:"fixed",top:74,right:10,borderRadius:4,minWidth:350,margin:0,width:"auto",zIndex:900},header:{backgroundColor:"rgb(138, 213, 137)"},closeBtn:{position:"absolute",top:6,right:8,fontSize:22},searchField:{display:"flex",alignItems:"center",width:"100%",height:40,padding:"2px 4px"},searchBox:{marginLeft:8,flex:1,border:"none !important"},searchBoxBtn:{padding:8},searchOptionsContainer:{padding:"5px 2px"},searchOption:{color:"rgba(0, 0, 0, 0.6)",cursor:"pointer"},searchBoxProgress:{marginRight:8},searchBoxDivider:{width:1,height:28,margin:4},resultWrapperOpen:{maxWidth:800},resultWrapperClosed:{maxWidth:350},resultContainer:{paddingTop:0,paddingBottom:0},resultTable:{boxShadow:"none"},inputBox:{width:240,marginTop:15},uploadBoxInput:{display:"none"},uploadBoxBtnEdit:{width:40,height:40,lineHeight:"40px",textAlign:"center",borderRadius:"50%",fontSize:22},wrapBtn:{position:"absolute",bottom:12,left:18,padding:10,fontSize:24},addPointWrapperOpen:{maxWidth:350},addPointWrapperClose:{width:0},uploadBoxBtnAdd:{width:90,height:90,lineHeight:"90px",textAlign:"center",borderRadius:"50%",fontSize:30,backgroundColor:"rgba(0, 0, 0, 0.08)"},previewImageContainer:{display:"flex",alignItems:"center"},nameTextField:{margin:"0 20px 0 13px"},pinyinTextField:{margin:"10px 20px 10px 13px"},introTextField:{width:"100%",marginTop:5},locationImageContainer:{display:"flex",flexDirection:"column",alignItems:"center"},locationImage:{display:"block",marginTop:5,width:225,height:140,borderRadius:3,cursor:"pointer"},locationLabel:{display:"block",marginTop:6},actions:{paddingTop:10},saveBtn:{display:"inline-block",position:"relative",marginRight:10},saveBtnProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}},Ot=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={open:!1,resultUnwrap:!1,addPointUnwrap:!1,optionsOpen:!1,searching:!1,submitting:!1,anchorEl:null,geometry:null,previewImage:null,previewMapUrl:null,previewCoordinate:{},loading:!0,traces:[],precipitationData:[],temperatureData:[],watsatData:[],layoutTemperature:{title:"Temperatura del Aire HC",xaxis:{title:"Fecha",type:"date"},yaxis:{title:"Temperatura (\xb0C)"}},layoutPrecipitation:{title:"Precipitaci\xf3n",xaxis:{title:"Fecha",type:"date"},yaxis:{title:"Precipitaci\xf3n (mm)"}},layoutWatsat:{title:"Modelo Watsat",xaxis:{title:"Fecha",type:"date"},yaxis:{title:"Contenido Volum\xe9trico de Agua"}},layout:{barmode:"stack",title:"Avistamientos de insectos por d\xeda",xaxis:{title:"Fecha",type:"date"},yaxis:{title:"Cantidad"}},items:[{id:1,title:"item #1"},{id:2,title:"item #2"},{id:3,title:"item #3"},{id:4,title:"item #4"},{id:5,title:"item #5"}],data:[],searchOptions:[{value:"gid",label:"Gid",checked:!0},{value:"name",label:"Name",checked:!0},{value:"pinyin",label:"Pinyin",checked:!0},{value:"introduction",label:"Introduction",checked:!1}]},a.initMaterialbox=function(){var e=document.querySelectorAll(".materialboxed");x.a.Materialbox.init(e,{onOpenStart:function(e){e.parentNode.style.overflow="visible"},onCloseEnd:function(e){e.parentNode.style.overflow="hidden"}})},a.resetPreviewImage=function(){a.setState({previewImage:null})},a.resetNewPointData=function(){a.setState({previewMapUrl:null,geometry:null,previewCoordinate:{}})},a.handleCloseClick=function(){a.setState({open:!1})},a.handleAddClick=function(){f.emit("getPoint"),a.handleWrapClick(),a.resetPreviewImage(),a.resetNewPointData(),a.setState({addPointUnwrap:!1})},a.handleWrapClick=function(){f.emit("removeTempLayer"),a.resetPreviewImage(),document.getElementById("search-box").value="",a.setState({resultUnwrap:!1})},a.handleImageChange=function(e){e.target.files[0]&&(e.target.files[0].size>1048576?f.emit("showSnackbar","error","Error: Image must be smaller than 1MB."):a.state.reader.readAsDataURL(e.target.files[0]))},a.handleDoneEdit=function(){a.resetPreviewImage(),setTimeout(a.initMaterialbox,800)},a.handleSearchOptionsClick=function(){a.setState({optionsOpen:!0})},a.handleSearchOptionsClose=function(){a.setState({optionsOpen:!1})},a.handleSearchOptionChange=function(e){var t=null,n=!1;if(a.state.searchOptions.map(function(a){return a.value===e.currentTarget.value&&(a.checked=e.currentTarget.checked,t=a),n=n||a.checked,!0}),!n)return f.emit("showSnackbar","error","Error: Please select at least one option."),void(t.checked=!0);a.setState({searchOptions:a.state.searchOptions})},a.handlePreviewClick=function(e,t){f.emit("displayTempLayer",t)},a.handlePreviewMapClick=function(){f.emit("getPoint"),a.setState({addPointUnwrap:!1})},a.handleDataSubmit=function(e){a.setState({url:e}),console.log("Datos recibidos en SearchController:",e),f.emit("moveURL",a.state.url)},a.moveCapa=function(){var e=a.state.capa;a.setState({movedCapa:e}),console.log(a.state.movedCapa),console.log(typeof a.state.movedCapa)},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=document.getElementById("anchorEl"),a=new FileReader;a.onload=function(t){var a=new Image;a.src=t.target.result;var n={longitude:a.height>a.width,src:t.target.result};e.setState({previewImage:n})},this.setState({reader:a,anchorEl:t}),this.openSearchControllerListener=f.addListener("openSearchController",function(){e.setState({open:!0})}),this.closeAllControllerListener=f.addListener("closeAllController",function(){e.setState({open:!1})}),this.updatePointListener=f.addListener("setPoint",function(t,a,n){var o=Object(He.a)(t.geometry.coordinates,2),r=o[0],i=o[1],l="https://api.mapbox.com/styles/v1/".concat(a,"/static/pin-s+f00(").concat(r,",").concat(i,")/").concat(r,",").concat(i,",").concat(n,",0,1/250x155@2x?access_token=").concat(_e);e.setState({addPointUnwrap:!0,previewMapUrl:l,geometry:t,previewCoordinate:{lng:parseFloat(r).toFixed(3),lat:parseFloat(i).toFixed(3)}})}),this.moveCapaListener=f.addListener("moveCapa",function(){e.moveCapa()})}},{key:"componentWillUnmount",value:function(){f.removeListener(this.openSearchControllerListener),f.removeListener(this.closeAllControllerListener),f.removeListener(this.addPointListener),f.removeListener(this.updatePointListener),document.querySelectorAll(".materialboxed").map(function(e){return e.destory()})}},{key:"render",value:function(){var e=this;return o.a.createElement(ft.a,{theme:Lt},o.a.createElement(kt.a,{direction:"left",in:this.state.open},o.a.createElement(vt.a,{style:It.root},o.a.createElement(yt.a,{style:It.header},o.a.createElement($.a,{gutterBottom:!0,style:{fontFamily:"Lato, Arial, sans-serif",color:"white",fontWeight:"3"},variant:"h5",component:"h2"},"Buscador por Ref. Catastral"),o.a.createElement(L.a,{style:It.closeBtn,"aria-label":"Close",onClick:function(){return e.setState({open:!1})}},o.a.createElement(I.a,{fontSize:"inherit"},"chevron_right"))),o.a.createElement(wt,{onSubmit:this.handleDataSubmit}))))}}]),t}(o.a.Component),Dt=a(601),Tt=a(588),Pt=a(607),Bt=a(584),jt=a(586),At=a(575),Ft=a(587),Rt=a(272),_t=a.n(Rt),Ut=a(582),Mt=a(572),Wt=a(594),Nt=a(273),zt=["Date Selection","Choose Equipment Type","Select Data Types"];function Ht(e){e.onSubmit;var t=Object(n.useState)(0),a=Object(He.a)(t,2),r=a[0],i=a[1],l=Object(n.useState)([]),s=Object(He.a)(l,2),c=s[0],d=s[1],p=Object(n.useState)({startDate:"",endDate:"",equipmentType:"",dataTypes:[]}),u=Object(He.a)(p,2),m=u[0],h=u[1],g=Object(n.useState)([]),f=Object(He.a)(g,2),v=f[0],y=f[1],b=function(e){var t=e.target,a=t.name,n=t.value;h(function(e){return Object(ve.a)({},e,Object(fe.a)({},a,n))}),"equipmentType"===a&&x(n)},x=function(){var e=Object(z.a)(N.a.mark(function e(t){var a,n;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost:5003/dataTypes/".concat(t));case 3:return a=e.sent,e.next=6,a.json();case 6:n=e.sent,y(n),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("Error fetching data types: ",e.t0);case 13:case"end":return e.stop()}},e,null,[[0,10]])}));return function(t){return e.apply(this,arguments)}}(),C={"Temperatura del aire HC":"\xb0C","Temperatura del bulbo h\xfamedo":"\xb0C","Punto de Roc\xedo":"\xb0C","Radiaci\xf3n solar":"W/m2",DPV:"kPa","Humedad relativa HC":"%","Precipitaci\xf3n":"mm","Humedad de la hoja":"m\xedn","Velocidad de Viento":"m/s","R\xe1fagas de Viento":"m/s","Direcci\xf3n de Viento":"deg","EnviroPro, sensor de humedad del suelo 1":"%","EnviroPro, sensor de humedad del suelo 2":"%","EnviroPro, sensor de humedad del suelo 3":"%","EnviroPro, sensor de humedad del suelo 4":"%","EnviroPro, sensor de humedad del suelo 5":"%","EnviroPro, sensor de humedad del suelo 6":"%","EnviroPro, sensor de humedad del suelo 7":"%","EnviroPro, sensor de humedad del suelo 8":"%","EnviroPro, sensor de temperatura del suelo 1":"\xb0C","EnviroPro, sensor de temperatura del suelo 2":"\xb0C","EnviroPro, sensor de temperatura del suelo 3":"\xb0C","EnviroPro, sensor de temperatura del suelo 4":"\xb0C","EnviroPro, sensor de temperatura del suelo 5":"\xb0C","EnviroPro, sensor de temperatura del suelo 6":"\xb0C","EnviroPro, sensor de temperatura del suelo 7":"\xb0C","EnviroPro, sensor de temperatura del suelo 8":"\xb0C","Panel solar":"mV","Bater\xeda":"mV",DeltaT:"\xb0C","Duraci\xf3n del sol":"m\xedn"},E=function(e){var t=m.dataTypes.map(function(t){console.log(t);var a,n=e.filter(function(e){return e.measurement===t}).sort(function(e,t){return new Date(e.sampling_date)-new Date(t.sampling_date)});return console.log(n),{type:"scatter",mode:"lines",x:n.map(function(e){return new Date(e.sampling_date)}),y:n.map(function(e){return e.measurement_value}),name:"".concat(t," (").concat((a=t,C[a]||""),")")}});d(t)},S=function(){var e=Object(z.a)(N.a.mark(function e(){var t,a,n;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost:5003/data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({category:m.equipmentType,dataTypes:m.dataTypes,startDate:m.startDate,endDate:m.endDate})});case 3:return t=e.sent,e.next=6,t.json();case 6:(a=e.sent)&&a.data&&(n=JSON.parse(a.data),console.log(n),E(n)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("Failed to fetch data: ",e.t0);case 13:case"end":return e.stop()}},e,null,[[0,10]])}));return function(){return e.apply(this,arguments)}}();return o.a.createElement(Dt.a,{sx:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}},o.a.createElement(Tt.a,{activeStep:r,sx:{width:"80%",marginBottom:2}},zt.map(function(e){return o.a.createElement(Pt.a,{key:e},o.a.createElement(Bt.a,null,e))})),o.a.createElement("div",null,r===zt.length?o.a.createElement(o.a.Fragment,null,o.a.createElement(Ct.a,{sx:{mt:2,mb:1}}),o.a.createElement(_t.a,{data:c,layout:{title:"Data Visualization"}}),o.a.createElement(xt.a,{onClick:function(){i(0),h({startDate:"",endDate:"",equipmentType:"",dataTypes:[]}),d([])}},"Reset"),o.a.createElement(xt.a,{variant:"contained",color:"primary",onClick:function(){var e=c.flatMap(function(e){return e.x.map(function(t,a){return{Date:t.toISOString(),Value:e.y[a],Trace:e.name}})}),t=[["Date","Value","Trace"]].concat(Object(ge.a)(e.map(function(e){return[e.Date,e.Value,e.Trace]}))).map(function(e){return e.join(",")}).join("\n"),a=new Blob([t],{type:"text/csv;charset=utf-8;"});Object(Nt.saveAs)(a,"data.csv")}},"Descargar CSV")):o.a.createElement(o.a.Fragment,null,function(e){switch(e){case 0:return o.a.createElement(Dt.a,{sx:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"}},o.a.createElement(bt.a,{label:"Start Date",type:"date",name:"startDate",value:m.startDate,onChange:b,InputLabelProps:{shrink:!0},sx:{margin:1}}),o.a.createElement(bt.a,{label:"End Date",type:"date",name:"endDate",value:m.endDate,onChange:b,InputLabelProps:{shrink:!0},sx:{margin:1}}));case 1:return o.a.createElement(Dt.a,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}},o.a.createElement(jt.a,{id:"equipment-type-label"},"Equipment Type"),o.a.createElement(At.a,{labelId:"equipment-type-label",id:"equipment-type-select",value:m.equipmentType,onChange:b,name:"equipmentType",sx:{width:200,margin:1}},o.a.createElement(Ft.a,{value:"Sensors"},"Sensors")));case 2:return o.a.createElement(Dt.a,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}},o.a.createElement(jt.a,{id:"data-type-label"},"Data Types"),o.a.createElement(At.a,{labelId:"data-type-label",id:"data-type-select",multiple:!0,value:m.dataTypes,onChange:b,name:"dataTypes",input:o.a.createElement(Wt.a,null),renderValue:function(e){return e.join(", ")},sx:{width:300,margin:1}},v.map(function(e){return o.a.createElement(Ft.a,{key:e,value:e},o.a.createElement(Ut.a,{checked:m.dataTypes.indexOf(e)>-1}),o.a.createElement(Mt.a,{primary:e}))})));default:return"Unknown step"}}(r),o.a.createElement(Dt.a,{sx:{display:"flex",flexDirection:"row",pt:2,alignItems:"center",justifyContent:"center"}},o.a.createElement(xt.a,{disabled:0===r,onClick:function(){i(function(e){return e-1})}},"Back"),o.a.createElement(xt.a,{onClick:function(){r===zt.length-1&&S(),i(function(e){return e+1})}},r===zt.length-1?"Finish":"Next")))))}var Vt=Object(gt.a)({palette:{primary:{main:Q.a.A200}}}),qt={root:{position:"fixed",top:74,right:10,borderRadius:4,minWidth:350,margin:0,width:900,zIndex:900},header:{backgroundColor:"rgb(138, 213, 137)"},closeBtn:{position:"absolute",top:6,right:8,fontSize:22},searchField:{display:"flex",alignItems:"center",width:"100%",height:40,padding:"2px 4px"},searchBox:{marginLeft:8,flex:1,border:"none !important"},searchBoxBtn:{padding:8},searchOptionsContainer:{padding:"5px 2px"},searchOption:{color:"rgba(0, 0, 0, 0.6)",cursor:"pointer"},searchBoxProgress:{marginRight:8},searchBoxDivider:{width:1,height:28,margin:4},resultWrapperOpen:{maxWidth:800},resultWrapperClosed:{maxWidth:350},resultContainer:{paddingTop:0,paddingBottom:0},resultTable:{boxShadow:"none"},uploadBoxInput:{display:"none"},uploadBoxBtnEdit:{width:40,height:40,lineHeight:"40px",textAlign:"center",borderRadius:"50%",fontSize:22},wrapBtn:{position:"absolute",bottom:12,left:18,padding:10,fontSize:24},addPointWrapperOpen:{maxWidth:350},addPointWrapperClose:{width:0},uploadBoxBtnAdd:{width:90,height:90,lineHeight:"90px",textAlign:"center",borderRadius:"50%",fontSize:30,backgroundColor:"rgba(0, 0, 0, 0.08)"},previewImageContainer:{display:"flex",alignItems:"center"},nameTextField:{margin:"0 20px 0 13px"},pinyinTextField:{margin:"10px 20px 10px 13px"},introTextField:{width:"100%",marginTop:5},locationImageContainer:{display:"flex",flexDirection:"column",alignItems:"center"},locationImage:{display:"block",marginTop:5,width:225,height:140,borderRadius:3,cursor:"pointer"},locationLabel:{display:"block",marginTop:6},actions:{paddingTop:10},saveBtn:{display:"inline-block",position:"relative",marginRight:10},saveBtnProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}},Gt=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={open:!1,resultUnwrap:!1,addPointUnwrap:!1,optionsOpen:!1,searching:!1,submitting:!1,anchorEl:null,geometry:null,previewImage:null,previewMapUrl:null,previewCoordinate:{},loading:!0,traces:[],precipitationData:[],temperatureData:[],watsatData:[],layoutTemperature:{title:"Temperatura del Aire HC",xaxis:{title:"Fecha",type:"date"},yaxis:{title:"Temperatura (\xb0C)"}},layoutPrecipitation:{title:"Precipitaci\xf3n",xaxis:{title:"Fecha",type:"date"},yaxis:{title:"Precipitaci\xf3n (mm)"}},layoutWatsat:{title:"Modelo Watsat",xaxis:{title:"Fecha",type:"date"},yaxis:{title:"Contenido Volum\xe9trico de Agua"}},layout:{barmode:"stack",title:"Avistamientos de insectos por d\xeda",xaxis:{title:"Fecha",type:"date"},yaxis:{title:"Cantidad"}},items:[{id:1,title:"item #1"},{id:2,title:"item #2"},{id:3,title:"item #3"},{id:4,title:"item #4"},{id:5,title:"item #5"}],data:[],searchOptions:[{value:"gid",label:"Gid",checked:!0},{value:"name",label:"Name",checked:!0},{value:"pinyin",label:"Pinyin",checked:!0},{value:"introduction",label:"Introduction",checked:!1}]},a.initMaterialbox=function(){var e=document.querySelectorAll(".materialboxed");x.a.Materialbox.init(e,{onOpenStart:function(e){e.parentNode.style.overflow="visible"},onCloseEnd:function(e){e.parentNode.style.overflow="hidden"}})},a.resetPreviewImage=function(){a.setState({previewImage:null})},a.resetNewPointData=function(){a.setState({previewMapUrl:null,geometry:null,previewCoordinate:{}})},a.handleCloseClick=function(){a.setState({open:!1})},a.handleAddClick=function(){f.emit("getPoint"),a.handleWrapClick(),a.resetPreviewImage(),a.resetNewPointData(),a.setState({addPointUnwrap:!1})},a.handleWrapClick=function(){f.emit("removeTempLayer"),a.resetPreviewImage(),document.getElementById("search-box").value="",a.setState({resultUnwrap:!1})},a.handleImageChange=function(e){e.target.files[0]&&(e.target.files[0].size>1048576?f.emit("showSnackbar","error","Error: Image must be smaller than 1MB."):a.state.reader.readAsDataURL(e.target.files[0]))},a.handleDoneEdit=function(){a.resetPreviewImage(),setTimeout(a.initMaterialbox,800)},a.handleSearchOptionsClick=function(){a.setState({optionsOpen:!0})},a.handleSearchOptionsClose=function(){a.setState({optionsOpen:!1})},a.handleSearchOptionChange=function(e){var t=null,n=!1;if(a.state.searchOptions.map(function(a){return a.value===e.currentTarget.value&&(a.checked=e.currentTarget.checked,t=a),n=n||a.checked,!0}),!n)return f.emit("showSnackbar","error","Error: Please select at least one option."),void(t.checked=!0);a.setState({searchOptions:a.state.searchOptions})},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=document.getElementById("anchorEl"),a=new FileReader;a.onload=function(t){var a=new Image;a.src=t.target.result;var n={longitude:a.height>a.width,src:t.target.result};e.setState({previewImage:n})},this.setState({reader:a,anchorEl:t}),this.openDataControllerListener=f.addListener("openDataController",function(){e.setState({open:!0})}),this.closeAllControllerListener=f.addListener("closeAllController",function(){e.setState({open:!1})}),this.updatePointListener=f.addListener("setPoint",function(t,a,n){var o=Object(He.a)(t.geometry.coordinates,2),r=o[0],i=o[1],l="https://api.mapbox.com/styles/v1/".concat(a,"/static/pin-s+f00(").concat(r,",").concat(i,")/").concat(r,",").concat(i,",").concat(n,",0,1/250x155@2x?access_token=").concat(_e);e.setState({addPointUnwrap:!0,previewMapUrl:l,geometry:t,previewCoordinate:{lng:parseFloat(r).toFixed(3),lat:parseFloat(i).toFixed(3)}})})}},{key:"componentWillUnmount",value:function(){f.removeListener(this.openDataControllerListener),f.removeListener(this.closeAllControllerListener),f.removeListener(this.addPointListener),f.removeListener(this.updatePointListener),document.querySelectorAll(".materialboxed").map(function(e){return e.destory()})}},{key:"render",value:function(){var e=this;return o.a.createElement(ft.a,{theme:Vt},o.a.createElement(J.a,{direction:"left",in:this.state.open},o.a.createElement(ce.a,{style:qt.root},o.a.createElement(de.a,{style:qt.header},o.a.createElement($.a,{gutterBottom:!0,style:{fontFamily:"Lato, Arial, sans-serif",color:"white",fontWeight:"3"},variant:"h5",component:"h2"},"Seleccionar Datos"),o.a.createElement(L.a,{style:qt.closeBtn,"aria-label":"Close",onClick:function(){return e.setState({open:!1})}},o.a.createElement(I.a,{fontSize:"inherit"},"chevron_right"))),"\xa0\xa0\xa0\xa0",o.a.createElement(Ht,null))))}}]),t}(o.a.Component),Zt=Object(O.b)({palette:{primary:{main:Q.a.A200}}}),Jt={root:{position:"fixed",top:74,right:10,borderRadius:4,minWidth:350,margin:0,zIndex:900},header:{backgroundColor:"rgb(138, 213, 137)"},content:{paddingBottom:16},closeBtn:{position:"absolute",top:6,right:8,fontSize:22},searchField:{display:"flex",alignItems:"center",width:"100%",height:40,padding:"2px 4px"},searchBox:{marginLeft:8,flex:1,border:"none !important"},searchBoxBtn:{padding:8},searchOptionsContainer:{padding:"5px 2px"},searchOption:{color:"rgba(0, 0, 0, 0.6)",cursor:"pointer"},searchBoxProgress:{marginRight:8},searchBoxDivider:{width:1,height:28,margin:4},resultWrapperOpen:{maxWidth:800},resultWrapperClosed:{maxWidth:350},resultContainer:{paddingTop:0,paddingBottom:0},resultTable:{boxShadow:"none"},uploadBoxInput:{display:"none"},uploadBoxBtnEdit:{width:40,height:40,lineHeight:"40px",textAlign:"center",borderRadius:"50%",fontSize:22},wrapBtn:{position:"absolute",bottom:12,left:18,padding:10,fontSize:24},addPointWrapperOpen:{maxWidth:350},addPointWrapperClose:{width:0},uploadBoxBtnAdd:{width:90,height:90,lineHeight:"90px",textAlign:"center",borderRadius:"50%",fontSize:30,backgroundColor:"rgba(0, 0, 0, 0.08)"},previewImageContainer:{display:"flex",alignItems:"center"},nameTextField:{margin:"0 20px 0 13px"},pinyinTextField:{margin:"10px 20px 10px 13px"},introTextField:{width:"100%",marginTop:5},locationImageContainer:{display:"flex",flexDirection:"column",alignItems:"center"},locationImage:{display:"block",marginTop:5,width:225,height:140,borderRadius:3,cursor:"pointer"},locationLabel:{display:"block",marginTop:6},actions:{paddingTop:10},saveBtn:{display:"inline-block",position:"relative",marginRight:10},saveBtnProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}},Yt=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={Ic:0,Ih:0,Ig:0,Io:0,If:0,IoType:0,sustainabilityIndex:null,decision:null,open:!1,resultUnwrap:!1,addPointUnwrap:!1,optionsOpen:!1,searching:!1,submitting:!1,anchorEl:null,geometry:null,previewImage:null,previewMapUrl:null,previewCoordinate:{},loading:!0,traces:[],precipitationData:[],temperatureData:[],watsatData:[],layoutTemperature:{title:"Temperatura del Aire HC",xaxis:{title:"Fecha",type:"date"},yaxis:{title:"Temperatura (\xb0C)"}},layoutPrecipitation:{title:"Precipitaci\xf3n",xaxis:{title:"Fecha",type:"date"},yaxis:{title:"Precipitaci\xf3n (mm)"}},layoutWatsat:{title:"Modelo Watsat",xaxis:{title:"Fecha",type:"date"},yaxis:{title:"Contenido Volum\xe9trico de Agua"}},layout:{barmode:"stack",title:"Avistamientos de insectos por d\xeda",xaxis:{title:"Fecha",type:"date"},yaxis:{title:"Cantidad"}},items:[{id:1,title:"item #1"},{id:2,title:"item #2"},{id:3,title:"item #3"},{id:4,title:"item #4"},{id:5,title:"item #5"}],data:[],searchOptions:[{value:"gid",label:"Gid",checked:!0},{value:"name",label:"Name",checked:!0},{value:"pinyin",label:"Pinyin",checked:!0},{value:"introduction",label:"Introduction",checked:!1}]},a.calculateSustainabilityIndex=function(){var e=1===a.state.Io?a.state.IoType:0,t=2.45*a.state.Ic+2.18*a.state.Ih+1.64*a.state.Ig+1.09*e+1*a.state.If;a.setState({sustainabilityIndex:t})},a.handleDecision=function(e){a.setState({decision:e})},a.initMaterialbox=function(){var e=document.querySelectorAll(".materialboxed");x.a.Materialbox.init(e,{onOpenStart:function(e){e.parentNode.style.overflow="visible"},onCloseEnd:function(e){e.parentNode.style.overflow="hidden"}})},a.resetPreviewImage=function(){a.setState({previewImage:null})},a.resetNewPointData=function(){a.setState({previewMapUrl:null,geometry:null,previewCoordinate:{}})},a.handleCloseClick=function(){a.setState({open:!1})},a.handleAddClick=function(){f.emit("getPoint"),a.handleWrapClick(),a.resetPreviewImage(),a.resetNewPointData(),a.setState({addPointUnwrap:!1})},a.handleWrapClick=function(){f.emit("removeTempLayer"),a.resetPreviewImage(),document.getElementById("search-box").value="",a.setState({resultUnwrap:!1})},a.handleImageChange=function(e){e.target.files[0]&&(e.target.files[0].size>1048576?f.emit("showSnackbar","error","Error: Image must be smaller than 1MB."):a.state.reader.readAsDataURL(e.target.files[0]))},a.handleDoneEdit=function(){a.resetPreviewImage(),setTimeout(a.initMaterialbox,800)},a.handleSearchOptionsClick=function(){a.setState({optionsOpen:!0})},a.handleSearchOptionsClose=function(){a.setState({optionsOpen:!1})},a.handleSearchOptionChange=function(e){var t=null,n=!1;if(a.state.searchOptions.map(function(a){return a.value===e.currentTarget.value&&(a.checked=e.currentTarget.checked,t=a),n=n||a.checked,!0}),!n)return f.emit("showSnackbar","error","Error: Please select at least one option."),void(t.checked=!0);a.setState({searchOptions:a.state.searchOptions})},a.handleSearchClick=function(){if(a.handleCancelClick(),document.getElementById("search-box").value){a.setState({searching:!0});var e={};a.state.searchOptions.map(function(t){return e[t.value]=t.checked,!0})}},a.handlePreviewClick=function(e,t){f.emit("displayTempLayer",t)},a.handlePreviewMapClick=function(){f.emit("getPoint"),a.setState({addPointUnwrap:!1})},a.handleSelectChange=function(e){a.setState(Object(fe.a)({},e.target.name,Number(e.target.value)))},a.calculateSustainabilityIndex=function(){var e=a.state,t=e.Ic,n=e.Ih,o=e.Ig,r=e.Io,i=e.If,l=e.IoType,s=2.45*t+2.18*n+1.64*o+1.09*(1===r?l:0)+1*i;a.setState({sustainabilityIndex:s})},a.processTemperatureData=function(e){var t={type:"scatter",mode:"lines",x:e.map(function(e){return new Date(e.sampling_date)}),y:e.map(function(e){return e.measurement_value}),name:"Temperatura del Aire HC"};a.setState({temperatureData:[t],loading:!1})},a.processPrecipitationData=function(e){var t={type:"scatter",mode:"lines",x:e.map(function(e){return new Date(e.sampling_date)}),y:e.map(function(e){return e.measurement_value}),name:"Precipitaci\xf3n"};a.setState({precipitationData:[t],loading:!1})},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=document.getElementById("anchorEl"),a=new FileReader;a.onload=function(t){var a=new Image;a.src=t.target.result;var n={longitude:a.height>a.width,src:t.target.result};e.setState({previewImage:n})},this.setState({reader:a,anchorEl:t}),this.openModelControllerListener=f.addListener("openModelController",function(){e.setState({open:!0})}),this.closeAllControllerListener=f.addListener("closeAllController",function(){e.setState({open:!1})}),this.updatePointListener=f.addListener("setPoint",function(t,a,n){var o=Object(He.a)(t.geometry.coordinates,2),r=o[0],i=o[1],l="https://api.mapbox.com/styles/v1/".concat(a,"/static/pin-s+f00(").concat(r,",").concat(i,")/").concat(r,",").concat(i,",").concat(n,",0,1/250x155@2x?access_token=").concat(_e);e.setState({addPointUnwrap:!0,previewMapUrl:l,geometry:t,previewCoordinate:{lng:parseFloat(r).toFixed(3),lat:parseFloat(i).toFixed(3)}})})}},{key:"setIc",value:function(e){this.setState({Ic:e})}},{key:"setIh",value:function(e){this.setState({Ih:e})}},{key:"setIg",value:function(e){this.setState({Ig:e})}},{key:"setIo",value:function(e){this.setState({Io:e})}},{key:"setIoType",value:function(e){this.setState({IoType:e})}},{key:"setIf",value:function(e){this.setState({If:e})}},{key:"componentWillUnmount",value:function(){f.removeListener(this.openModelControllerListener),f.removeListener(this.closeAllControllerListener),f.removeListener(this.addPointListener),f.removeListener(this.updatePointListener),document.querySelectorAll(".materialboxed").map(function(e){return e.destory()})}},{key:"render",value:function(){var e=this,t=this.state,a=t.open,n=t.Ic,r=t.Ih,i=t.Ig,l=t.Io,s=t.If,c=t.IoType,d=t.sustainabilityIndex;return o.a.createElement(D.a,{theme:Zt},o.a.createElement(J.a,{direction:"left",in:a},o.a.createElement(ce.a,{style:Jt.root},o.a.createElement(de.a,{style:Jt.header},o.a.createElement($.a,{gutterBottom:!0,style:{fontFamily:"Lato, Arial, sans-serif",color:"white",fontWeight:"3"},variant:"h5",component:"h2"},"Visualizador de capas"),o.a.createElement($.a,{variant:"body2",color:"textSecondary"},"\xc1rbol de Decisi\xf3n para la Sostenibilidad del Olivar"),o.a.createElement(L.a,{style:Jt.closeBtn,"aria-label":"Close",onClick:function(){return e.setState({open:!1})}},o.a.createElement(I.a,{fontSize:"inherit"},"chevron_right"))),o.a.createElement(de.a,{style:Jt.content},o.a.createElement(st.a,{fullWidth:!0,margin:"normal"},o.a.createElement(ct.a,null,"\xbfMantiene una cubierta vegetal en el suelo de su olivar?"),o.a.createElement(dt.a,{name:"Ic",value:n,onChange:this.handleSelectChange},o.a.createElement(pt.a,{value:0},"No"),o.a.createElement(pt.a,{value:1},"En bandas"),o.a.createElement(pt.a,{value:2},"Toda la superficie menos los ruedos"),o.a.createElement(pt.a,{value:3},"Toda la superficie, incluyendo los ruedos"))),o.a.createElement(st.a,{fullWidth:!0,margin:"normal"},o.a.createElement(ct.a,null,"\xbfConserva alg\xfan tipo de vegetaci\xf3n natural en su olivar?"),o.a.createElement(dt.a,{name:"Ih",value:r,onChange:this.handleSelectChange},o.a.createElement(pt.a,{value:0},"No"),o.a.createElement(pt.a,{value:1},"Conservo algunos \xe1rboles dispersos"),o.a.createElement(pt.a,{value:2},"Conservo parches de vegetaci\xf3n natural"),o.a.createElement(pt.a,{value:3},"Conservo una o varias manchas importantes de monte mediterr\xe1neo"))),o.a.createElement(st.a,{fullWidth:!0,margin:"normal"},o.a.createElement(ct.a,null,"\xbfSuele incorporar ganado a pastar dentro de su olivar?"),o.a.createElement(dt.a,{name:"Ig",value:i,onChange:this.handleSelectChange},o.a.createElement(pt.a,{value:0},"No"),o.a.createElement(pt.a,{value:1},"S\xed"))),o.a.createElement(st.a,{fullWidth:!0,margin:"normal"},o.a.createElement(ct.a,null,"\xbfSuministra a sus suelos alg\xfan tipo de fertilizante org\xe1nico?"),o.a.createElement(dt.a,{name:"Io",value:l,onChange:this.handleSelectChange},o.a.createElement(pt.a,{value:0},"No"),o.a.createElement(pt.a,{value:1},"S\xed")),1===l&&o.a.createElement(st.a,{fullWidth:!0,margin:"normal"},o.a.createElement(ct.a,null,"\xbfCu\xe1l de los siguientes fertilizantes org\xe1nicos emplea?"),o.a.createElement(dt.a,{name:"IoType",value:c,onChange:this.handleSelectChange},o.a.createElement(pt.a,{value:1},"Restos triturados de la poda"),o.a.createElement(pt.a,{value:1},"Alperujo compostado"),o.a.createElement(pt.a,{value:1},"Esti\xe9rcol"),o.a.createElement(pt.a,{value:1},"Otros tipos"),o.a.createElement(pt.a,{value:2},"Dos de los anteriores"),o.a.createElement(pt.a,{value:3},"Tres o m\xe1s de los anteriores")))),o.a.createElement(st.a,{fullWidth:!0,margin:"normal"},o.a.createElement(ct.a,null,"\xbfCu\xe1l de los siguientes productos fitosanitarios NO aplica en su olivar?"),o.a.createElement(dt.a,{name:"If",value:s,onChange:this.handleSelectChange},o.a.createElement(pt.a,{value:0},"Aplico todos los anteriores"),o.a.createElement(pt.a,{value:1},"No aplico fungicidas"),o.a.createElement(pt.a,{value:2},"No aplico herbicidas"),o.a.createElement(pt.a,{value:3},"No aplico pesticidas"))),o.a.createElement(g.a,{variant:"contained",color:"primary",onClick:this.calculateSustainabilityIndex,style:{marginTop:20}},"Calcular \xcdndice de Sostenibilidad"),null!==d&&o.a.createElement($.a,{variant:"h6",style:{marginTop:20}},"\xcdndice de Sostenibilidad: ",d.toFixed(2))))))}}]),t}(o.a.Component),$t=a(180),Kt=["Select Table","Upload Data","Finish"];function Qt(e){e.onSubmit;var t=Object(n.useState)(0),a=Object(He.a)(t,2),r=a[0],i=a[1],l=Object(n.useState)([]),s=Object(He.a)(l,2),c=s[0],d=s[1],p=Object(n.useState)(""),u=Object(He.a)(p,2),m=u[0],h=u[1],g=Object(n.useState)(null),f=Object(He.a)(g,2),v=f[0],y=f[1],b=function(e){h(e.target.value)},x=Object($t.b)({onDrop:function(e){y(e[0])},accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),C=x.getRootProps,E=x.getInputProps,S=x.isDragActive,w=function(){var e=Object(z.a)(N.a.mark(function e(){var t,a;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("http://localhost:5003/api/tables");case 3:return t=e.sent,e.next=6,t.json();case 6:a=e.sent,d(a),console.log(a),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("Error fetching tables: ",e.t0);case 14:case"end":return e.stop()}},e,null,[[0,11]])}));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)(function(){w()},[]);var k=function(){var e=new FormData;e.append("file",v),e.append("table",m),ae.a.post("http://localhost:5003/api/upload",e,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){console.log("File uploaded successfully",e.data),i(function(e){return e+1})}).catch(function(e){console.error("Error uploading file",e)})};return o.a.createElement(Dt.a,{sx:{width:"100%"}},o.a.createElement(Tt.a,{activeStep:r,alternativeLabel:!0},Kt.map(function(e){return o.a.createElement(Pt.a,{key:e},o.a.createElement(Bt.a,null,e))})),o.a.createElement("div",null,r===Kt.length?o.a.createElement(o.a.Fragment,null,o.a.createElement(Dt.a,{sx:{display:"flex",flexDirection:"row",pt:2,alignItems:"center",justifyContent:"center"}},o.a.createElement(xt.a,{onClick:function(){i(0),h(""),y(null)}},"Reset"))):o.a.createElement(o.a.Fragment,null,o.a.createElement(Dt.a,{sx:{display:"flex",flexDirection:"row",pt:2,alignItems:"center",justifyContent:"center"}},function(e){switch(e){case 0:return o.a.createElement(At.a,{value:m,onChange:b,displayEmpty:!0,fullWidth:!0},o.a.createElement(Ft.a,{value:""}),c.map(function(e){return o.a.createElement(Ft.a,{key:e,value:e},e)}));case 1:return o.a.createElement("div",Object.assign({},C(),{style:{border:"1px solid black",padding:20,cursor:"pointer"}}),o.a.createElement("input",E()),S?o.a.createElement("p",null,"Drop the files here ..."):o.a.createElement("p",null,"Drag 'n' drop some files here, or click to select files"));case 2:return o.a.createElement(Ct.a,null,"All steps completed - you're finished");default:return"Unknown step"}}(r),o.a.createElement(xt.a,{disabled:0===r,onClick:function(){i(function(e){return e-1})}},"Back"),o.a.createElement(xt.a,{onClick:function(){1===r&&v?k():i(function(e){return e+1})}},r===Kt.length-1?"Finish":"Next")))))}var Xt=Object(gt.a)({palette:{primary:{main:Q.a.A200}}}),ea={root:{position:"fixed",top:74,right:10,borderRadius:4,minWidth:350,margin:0,width:900,zIndex:900},header:{backgroundColor:"#f1f1f1"},closeBtn:{position:"absolute",top:6,right:8,fontSize:22},searchField:{display:"flex",alignItems:"center",width:"100%",height:40,padding:"2px 4px"},searchBox:{marginLeft:8,flex:1,border:"none !important"},searchBoxBtn:{padding:8},searchOptionsContainer:{padding:"5px 2px"},searchOption:{color:"rgba(0, 0, 0, 0.6)",cursor:"pointer"},searchBoxProgress:{marginRight:8},searchBoxDivider:{width:1,height:28,margin:4},resultWrapperOpen:{maxWidth:800},resultWrapperClosed:{maxWidth:350},resultContainer:{paddingTop:0,paddingBottom:0},resultTable:{boxShadow:"none"},uploadBoxInput:{display:"none"},uploadBoxBtnEdit:{width:40,height:40,lineHeight:"40px",textAlign:"center",borderRadius:"50%",fontSize:22},wrapBtn:{position:"absolute",bottom:12,left:18,padding:10,fontSize:24},addPointWrapperOpen:{maxWidth:350},addPointWrapperClose:{width:0},uploadBoxBtnAdd:{width:90,height:90,lineHeight:"90px",textAlign:"center",borderRadius:"50%",fontSize:30,backgroundColor:"rgba(0, 0, 0, 0.08)"},previewImageContainer:{display:"flex",alignItems:"center"},nameTextField:{margin:"0 20px 0 13px"},pinyinTextField:{margin:"10px 20px 10px 13px"},introTextField:{width:"100%",marginTop:5},locationImageContainer:{display:"flex",flexDirection:"column",alignItems:"center"},locationImage:{display:"block",marginTop:5,width:225,height:140,borderRadius:3,cursor:"pointer"},locationLabel:{display:"block",marginTop:6},actions:{paddingTop:10},saveBtn:{display:"inline-block",position:"relative",marginRight:10},saveBtnProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}},ta=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={open:!1,resultUnwrap:!1,addPointUnwrap:!1,optionsOpen:!1,searching:!1,submitting:!1,anchorEl:null,geometry:null,previewImage:null,previewMapUrl:null,previewCoordinate:{},loading:!0,traces:[],precipitationData:[],temperatureData:[],watsatData:[],layoutTemperature:{title:"Temperatura del Aire HC",xaxis:{title:"Fecha",type:"date"},yaxis:{title:"Temperatura (\xb0C)"}},layoutPrecipitation:{title:"Precipitaci\xf3n",xaxis:{title:"Fecha",type:"date"},yaxis:{title:"Precipitaci\xf3n (mm)"}},layoutWatsat:{title:"Modelo Watsat",xaxis:{title:"Fecha",type:"date"},yaxis:{title:"Contenido Volum\xe9trico de Agua"}},layout:{barmode:"stack",title:"Avistamientos de insectos por d\xeda",xaxis:{title:"Fecha",type:"date"},yaxis:{title:"Cantidad"}},items:[{id:1,title:"item #1"},{id:2,title:"item #2"},{id:3,title:"item #3"},{id:4,title:"item #4"},{id:5,title:"item #5"}],data:[],searchOptions:[{value:"gid",label:"Gid",checked:!0},{value:"name",label:"Name",checked:!0},{value:"pinyin",label:"Pinyin",checked:!0},{value:"introduction",label:"Introduction",checked:!1}]},a.initMaterialbox=function(){var e=document.querySelectorAll(".materialboxed");x.a.Materialbox.init(e,{onOpenStart:function(e){e.parentNode.style.overflow="visible"},onCloseEnd:function(e){e.parentNode.style.overflow="hidden"}})},a.resetPreviewImage=function(){a.setState({previewImage:null})},a.resetNewPointData=function(){a.setState({previewMapUrl:null,geometry:null,previewCoordinate:{}})},a.handleCloseClick=function(){a.setState({open:!1})},a.handleAddClick=function(){f.emit("getPoint"),a.handleWrapClick(),a.resetPreviewImage(),a.resetNewPointData(),a.setState({addPointUnwrap:!1})},a.handleWrapClick=function(){f.emit("removeTempLayer"),a.resetPreviewImage(),document.getElementById("search-box").value="",a.setState({resultUnwrap:!1})},a.handleImageChange=function(e){e.target.files[0]&&(e.target.files[0].size>1048576?f.emit("showSnackbar","error","Error: Image must be smaller than 1MB."):a.state.reader.readAsDataURL(e.target.files[0]))},a.handleDoneEdit=function(){a.resetPreviewImage(),setTimeout(a.initMaterialbox,800)},a.handleSearchOptionsClick=function(){a.setState({optionsOpen:!0})},a.handleSearchOptionsClose=function(){a.setState({optionsOpen:!1})},a.handleSearchOptionChange=function(e){var t=null,n=!1;if(a.state.searchOptions.map(function(a){return a.value===e.currentTarget.value&&(a.checked=e.currentTarget.checked,t=a),n=n||a.checked,!0}),!n)return f.emit("showSnackbar","error","Error: Please select at least one option."),void(t.checked=!0);a.setState({searchOptions:a.state.searchOptions})},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=document.getElementById("anchorEl"),a=new FileReader;a.onload=function(t){var a=new Image;a.src=t.target.result;var n={longitude:a.height>a.width,src:t.target.result};e.setState({previewImage:n})},this.setState({reader:a,anchorEl:t}),this.openImportControllerListener=f.addListener("openImportController",function(){e.setState({open:!0})}),this.closeAllControllerListener=f.addListener("closeAllController",function(){e.setState({open:!1})}),this.updatePointListener=f.addListener("setPoint",function(t,a,n){var o=Object(He.a)(t.geometry.coordinates,2),r=o[0],i=o[1],l="https://api.mapbox.com/styles/v1/".concat(a,"/static/pin-s+f00(").concat(r,",").concat(i,")/").concat(r,",").concat(i,",").concat(n,",0,1/250x155@2x?access_token=").concat(_e);e.setState({addPointUnwrap:!0,previewMapUrl:l,geometry:t,previewCoordinate:{lng:parseFloat(r).toFixed(3),lat:parseFloat(i).toFixed(3)}})})}},{key:"componentWillUnmount",value:function(){f.removeListener(this.openImportControllerListener),f.removeListener(this.closeAllControllerListener),f.removeListener(this.addPointListener),f.removeListener(this.updatePointListener),document.querySelectorAll(".materialboxed").map(function(e){return e.destory()})}},{key:"render",value:function(){return o.a.createElement(ft.a,{theme:Xt},o.a.createElement(J.a,{direction:"left",in:this.state.open},o.a.createElement(ce.a,{style:ea.root},o.a.createElement(de.a,{style:ea.header},o.a.createElement($.a,{variant:"h5",className:ea.title},"Data Importer"),o.a.createElement(Qt,null)))))}}]),t}(o.a.Component),aa=Object(Ve.a)(function(e){return{root:{width:"100%"},formControl:{margin:e.spacing(1),minWidth:120,width:"100%"},dateInput:{width:"100%"},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},progressText:{marginLeft:e.spacing(2)}}});function na(e){var t=e.onSubmit,a=aa(),r=Object(n.useState)(!1),i=Object(He.a)(r,2),l=i[0],s=i[1],c=Object(n.useState)({startDate:"2000-04-14",endDate:"2024-05-14",indexType:"NDVI",aoiDataFiles:[]}),d=Object(He.a)(c,2),p=d[0],u=d[1],m=Object(n.useState)(!1),h=Object(He.a)(m,2),v=h[0],y=h[1],b=Object(n.useState)(0),x=Object(He.a)(b,2),C=x[0],E=x[1];Object(n.useEffect)(function(){var e;return v?e=setInterval(function(){E(function(e){return e+1})},1e3):clearInterval(e),function(){return clearInterval(e)}},[v]);var S,w=function(e){var t=e.target,a=t.name,n=t.value;u(function(e){return Object(ve.a)({},e,Object(fe.a)({},a,n))})},k=function(){var e=Object(z.a)(N.a.mark(function e(){var a,n,o;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,y(!0),E(0),(a=new FormData).append("aoiDataFiles",p.aoiDataFiles[0]),a.append("indexType",p.indexType),a.append("startDate",p.startDate),a.append("endDate",p.endDate),e.next=10,fetch("http://localhost:5004/api/vegetation_index_change_inspector",{method:"POST",body:a});case 10:return n=e.sent,e.next=13,n.json();case 13:if(o=e.sent,console.log(o),!o){e.next=22;break}return console.log("Data sent successfully",o.output),t(o.output),y(!1),f.emit("closeAllController"),f.emit("openLayerController"),e.abrupt("return",!0);case 22:e.next=29;break;case 24:e.prev=24,e.t0=e.catch(0),y(!1),f.emit("showSnackbar","error","Error: '".concat(e.t0,"'")),console.error("Failed to send data",e.t0);case 29:case"end":return e.stop()}},e,null,[[0,24]])}));return function(){return e.apply(this,arguments)}}();return o.a.createElement("div",{className:a.root},o.a.createElement(Ke.a,{expanded:"panel1"===l,onChange:(S="panel1",function(e,t){s(!!t&&S)})},o.a.createElement(Xe.a,{expandIcon:o.a.createElement(tt.a,null),"aria-controls":"panel1bh-content",id:"panel1bh-header"},o.a.createElement($.a,{className:a.heading},"Choose a veg index")),o.a.createElement(Qe.a,null,o.a.createElement($e.a,{onChange:function(e){return function(e,t){if(t&&t.length>0){var a=new FileReader;a.onload=function(){var e=Object(z.a)(N.a.mark(function e(t){return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.readAsArrayBuffer(t[0])}u(function(a){return Object(ve.a)({},a,Object(fe.a)({},e,t))})}("aoiDataFiles",e)},acceptedFiles:[".zip"],dropzoneText:"Area of Interest",maxFileSize:5e6,filesLimit:1,getPreviewIcon:function(e,t){var a=e.file.type,n={className:t.image};if(a.startsWith("video/"))return o.a.createElement(Ge.a,n);switch(a){case"application/msword":case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":return o.a.createElement(Ze.a,n);case"application/pdf":return o.a.createElement(Je.a,n);default:return o.a.createElement(Ye.a,n)}}})),o.a.createElement(Qe.a,null,o.a.createElement(pe.a,{container:!0,spacing:2},o.a.createElement(pe.a,{item:!0,xs:12,sm:6},o.a.createElement(Y.a,{label:"Start Date",type:"date",name:"startDate",value:p.startDate,onChange:w,className:a.dateInput,InputLabelProps:{shrink:!0}})),o.a.createElement(pe.a,{item:!0,xs:12,sm:6},o.a.createElement(Y.a,{label:"End Date",type:"date",name:"endDate",value:p.endDate,onChange:w,className:a.dateInput,InputLabelProps:{shrink:!0}})),o.a.createElement(pe.a,{item:!0,xs:12,sm:12},o.a.createElement(st.a,{className:a.formControl},o.a.createElement(ct.a,{id:"index-type-label"},"Index Type"),o.a.createElement(dt.a,{labelId:"index-type-label",id:"index-type-select",value:p.indexType,onChange:w,name:"indexType"},o.a.createElement(pt.a,{value:"NDVI"},"NDVI"),o.a.createElement(pt.a,{value:"EVI"},"EVI"),o.a.createElement(pt.a,{value:"SAVI"},"SAVI"))))))),o.a.createElement(pe.a,{container:!0,justifyContent:"flex-end"},o.a.createElement(g.a,{onClick:k,color:"primary",variant:"contained"},"Submit Data")),o.a.createElement(qe.a,{className:a.backdrop,open:v},o.a.createElement(G.a,{color:"inherit"}),o.a.createElement($.a,{variant:"h6",className:a.progressText},"Loading... ",C,"s")))}var oa=Object(O.b)({palette:{primary:{main:Q.a.A200}}}),ra={root:{position:"fixed",top:74,right:10,borderRadius:9,minWidth:350,margin:0,zIndex:900,boxShadow:"-6px 6px 15px rgba(0, 0, 0, 0.15)"},rooot:{width:"100%"},heading:{fontSize:oa.typography.pxToRem(15),flexBasis:"33.33%",flexShrink:0},secondaryHeading:{fontSize:oa.typography.pxToRem(15),color:oa.palette.text.secondary},header:{backgroundColor:"rgba(33,150,243,255)"},content:{paddingBottom:16},closeBtn:{position:"absolute",top:6,right:8,fontSize:22},searchField:{display:"flex",alignItems:"center",width:"100%",height:40,padding:"2px 4px"},searchBox:{marginLeft:8,flex:1,border:"none !important"},searchBoxBtn:{padding:8},searchOptionsContainer:{padding:"5px 2px"},searchOption:{color:"rgba(0, 0, 0, 0.6)",cursor:"pointer"},searchBoxProgress:{marginRight:8},searchBoxDivider:{width:1,height:28,margin:4},resultWrapperOpen:{maxWidth:800},resultWrapperClosed:{maxWidth:350},resultContainer:{paddingTop:0,paddingBottom:0},resultTable:{boxShadow:"none"},uploadBoxInput:{display:"none"},uploadBoxBtnEdit:{width:40,height:40,lineHeight:"40px",textAlign:"center",borderRadius:"50%",fontSize:22},wrapBtn:{position:"absolute",bottom:12,left:18,padding:10,fontSize:24},addPointWrapperOpen:{maxWidth:350},addPointWrapperClose:{width:0},uploadBoxBtnAdd:{width:90,height:90,lineHeight:"90px",textAlign:"center",borderRadius:"50%",fontSize:30,backgroundColor:"rgba(0, 0, 0, 0.08)"},previewImageContainer:{display:"flex",alignItems:"center"},nameTextField:{margin:"0 20px 0 13px"},pinyinTextField:{margin:"10px 20px 10px 13px"},introTextField:{width:"100%",marginTop:5},locationImageContainer:{display:"flex",flexDirection:"column",alignItems:"center"},locationImage:{display:"block",marginTop:5,width:225,height:140,borderRadius:3,cursor:"pointer"},locationLabel:{display:"block",marginTop:6},actions:{paddingTop:10},saveBtn:{display:"inline-block",position:"relative",marginRight:10},saveBtnProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}},ia=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={open:!1},a.handleCloseClick=function(){a.setState({open:!1})},a.handleDataSubmit=function(e){a.setState({url:e}),console.log("Datos recibidos en BandController:",e),f.emit("moveURL",a.state.url)},a.handleWrapClick=function(){f.emit("removeTempLayer"),a.resetPreviewImage(),document.getElementById("search-box").value="",a.setState({resultUnwrap:!1})},a.handleSearchOptionChange=function(e){var t=null,n=!1;if(a.state.searchOptions.map(function(a){return a.value===e.currentTarget.value&&(a.checked=e.currentTarget.checked,t=a),n=n||a.checked,!0}),!n)return f.emit("showSnackbar","error","Error: Please select at least one option."),void(t.checked=!0);a.setState({searchOptions:a.state.searchOptions})},a.handleSearchClick=function(){if(a.handleCancelClick(),document.getElementById("search-box").value){a.setState({searching:!0});var e={};a.state.searchOptions.map(function(t){return e[t.value]=t.checked,!0})}},a.handlePreviewClick=function(e,t){f.emit("displayTempLayer",t)},a.handlePreviewMapClick=function(){f.emit("getPoint"),a.setState({addPointUnwrap:!1})},a.handleSelectChange=function(e){a.setState(Object(fe.a)({},e.target.name,Number(e.target.value)))},a.handleCancelClick=function(){f.emit("removeTempPoint"),document.getElementById("name").value="",document.getElementById("pinyin").value="",document.getElementById("introduction").value="",a.resetPreviewImage(),a.resetNewPointData(),a.setState({addPointUnwrap:!1})},a.moveURL=function(){var e=a.state.url;a.setState({movedURL:e}),console.log(a.state.movedURL)},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=document.getElementById("anchorEl"),a=new FileReader;a.onload=function(t){var a=new Image;a.src=t.target.result;var n={longitude:a.height>a.width,src:t.target.result};e.setState({previewImage:n})},this.setState({reader:a,anchorEl:t}),this.openVegInspectorControllerListener=f.addListener("openVegInspectorController",function(){e.setState({open:!0})}),this.closeAllControllerListener=f.addListener("closeAllController",function(){e.setState({open:!1})}),this.updatePointListener=f.addListener("setPoint",function(t,a,n){var o=Object(He.a)(t.geometry.coordinates,2),r=o[0],i=o[1],l="https://api.mapbox.com/styles/v1/".concat(a,"/static/pin-s+f00(").concat(r,",").concat(i,")/").concat(r,",").concat(i,",").concat(n,",0,1/250x155@2x?access_token=").concat(_e);e.setState({addPointUnwrap:!0,previewMapUrl:l,geometry:t,previewCoordinate:{lng:parseFloat(r).toFixed(3),lat:parseFloat(i).toFixed(3)}})}),this.moveURListener=f.addListener("moveURL",function(){e.moveURL()})}},{key:"componentWillUnmount",value:function(){f.removeListener(this.openBandControllerListener),f.removeListener(this.closeAllControllerListener),f.removeListener(this.addPointListener),f.removeListener(this.updatePointListener),f.removeListener(this.moveURListener),document.querySelectorAll(".materialboxed").map(function(e){return e.destory()})}},{key:"render",value:function(){return o.a.createElement(D.a,{theme:oa},o.a.createElement(J.a,{direction:"left",in:this.state.open},o.a.createElement(ce.a,{style:ra.root},o.a.createElement(de.a,{style:ra.header},o.a.createElement($.a,{gutterBottom:!0,variant:"h5",component:"h2",style:{fontFamily:"Lato, Arial, sans-serif",color:"white",fontWeight:"3"}},"Vegetation Change Inspec."),o.a.createElement($.a,{variant:"body2",color:"textSecondary"},"Upload your shape and map the veg. index result")),o.a.createElement(de.a,{style:ra.content},o.a.createElement(na,{onSubmit:this.handleDataSubmit}),o.a.createElement(L.a,{style:ra.closeBtn,"aria-label":"Close",onClick:this.handleCloseClick},o.a.createElement(I.a,{fontSize:"inherit"},"chevron_right"))))))}}]),t}(o.a.Component),la=Object(O.b)({palette:{primary:{main:Q.a.A200}}}),sa={root:{position:"fixed",top:74,right:10,borderRadius:9,minWidth:350,margin:0,zIndex:900},rooot:{width:"100%"},content:{paddingBottom:16},heading:{fontSize:la.typography.pxToRem(15),flexBasis:"33.33%",flexShrink:0},secondaryHeading:{fontSize:la.typography.pxToRem(15),color:la.palette.text.secondary},header:{backgroundColor:"rgba(255,152,0,255)"},closeBtn:{position:"absolute",top:6,right:8,fontSize:22},searchField:{display:"flex",alignItems:"center",width:"100%",height:40,padding:"2px 4px"},searchBox:{marginLeft:8,flex:1,border:"none !important"},searchBoxBtn:{padding:8},searchOptionsContainer:{padding:"5px 2px"},searchOption:{color:"rgba(0, 0, 0, 0.6)",cursor:"pointer"},searchBoxProgress:{marginRight:8},searchBoxDivider:{width:1,height:28,margin:4},resultWrapperOpen:{maxWidth:800},resultWrapperClosed:{maxWidth:350},resultContainer:{paddingTop:0,paddingBottom:0},resultTable:{boxShadow:"none"},uploadBoxInput:{display:"none"},uploadBoxBtnEdit:{width:40,height:40,lineHeight:"40px",textAlign:"center",borderRadius:"50%",fontSize:22},wrapBtn:{position:"absolute",bottom:12,left:18,padding:10,fontSize:24},addPointWrapperOpen:{maxWidth:350},addPointWrapperClose:{width:0},uploadBoxBtnAdd:{width:90,height:90,lineHeight:"90px",textAlign:"center",borderRadius:"50%",fontSize:30,backgroundColor:"rgba(0, 0, 0, 0.08)"},previewImageContainer:{display:"flex",alignItems:"center"},nameTextField:{margin:"0 20px 0 13px"},pinyinTextField:{margin:"10px 20px 10px 13px"},introTextField:{width:"100%",marginTop:5},locationImageContainer:{display:"flex",flexDirection:"column",alignItems:"center"},locationImage:{display:"block",marginTop:5,width:225,height:140,borderRadius:3,cursor:"pointer"},locationLabel:{display:"block",marginTop:6},actions:{paddingTop:10},saveBtn:{display:"inline-block",position:"relative",marginRight:10},saveBtnProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}},ca=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={open:!1},a.handleCloseClick=function(){a.setState({open:!1})},a.handleDataSubmit=function(e){a.setState({url:e}),console.log("Datos recibidos en BandController:",e),f.emit("moveURL",a.state.url)},a.handleWrapClick=function(){f.emit("removeTempLayer"),a.resetPreviewImage(),document.getElementById("search-box").value="",a.setState({resultUnwrap:!1})},a.handleSearchOptionChange=function(e){var t=null,n=!1;if(a.state.searchOptions.map(function(a){return a.value===e.currentTarget.value&&(a.checked=e.currentTarget.checked,t=a),n=n||a.checked,!0}),!n)return f.emit("showSnackbar","error","Error: Please select at least one option."),void(t.checked=!0);a.setState({searchOptions:a.state.searchOptions})},a.handlePreviewClick=function(e,t){f.emit("displayTempLayer",t)},a.handlePreviewMapClick=function(){f.emit("getPoint"),a.setState({addPointUnwrap:!1})},a.handleSelectChange=function(e){a.setState(Object(fe.a)({},e.target.name,Number(e.target.value)))},a.handleCancelClick=function(){f.emit("removeTempPoint"),document.getElementById("name").value="",document.getElementById("pinyin").value="",document.getElementById("introduction").value="",a.resetPreviewImage(),a.resetNewPointData(),a.setState({addPointUnwrap:!1})},a.moveURL=function(){var e=a.state.url;a.setState({movedURL:e}),console.log(a.state.movedURL)},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=document.getElementById("anchorEl"),a=new FileReader;a.onload=function(t){var a=new Image;a.src=t.target.result;var n={longitude:a.height>a.width,src:t.target.result};e.setState({previewImage:n})},this.setState({reader:a,anchorEl:t}),this.openSpatioTemporalAnalysisControllerListener=f.addListener("openSpatioTemporalAnalysisController",function(){e.setState({open:!0})}),this.closeAllControllerListener=f.addListener("closeAllController",function(){e.setState({open:!1})}),this.updatePointListener=f.addListener("setPoint",function(t,a,n){var o=Object(He.a)(t.geometry.coordinates,2),r=o[0],i=o[1],l="https://api.mapbox.com/styles/v1/".concat(a,"/static/pin-s+f00(").concat(r,",").concat(i,")/").concat(r,",").concat(i,",").concat(n,",0,1/250x155@2x?access_token=").concat(_e);e.setState({addPointUnwrap:!0,previewMapUrl:l,geometry:t,previewCoordinate:{lng:parseFloat(r).toFixed(3),lat:parseFloat(i).toFixed(3)}})}),this.moveURListener=f.addListener("moveURL",function(){e.moveURL()})}},{key:"componentWillUnmount",value:function(){f.removeListener(this.openSpatioTemporalAnalysisControllerListener),f.removeListener(this.closeAllControllerListener),f.removeListener(this.addPointListener),f.removeListener(this.updatePointListener),f.removeListener(this.moveURListener),document.querySelectorAll(".materialboxed").map(function(e){return e.destory()})}},{key:"render",value:function(){return o.a.createElement(D.a,{theme:la},o.a.createElement(J.a,{direction:"left",in:this.state.open},o.a.createElement(ce.a,{style:sa.root},o.a.createElement(de.a,{style:sa.header},o.a.createElement($.a,{gutterBottom:!0,style:{fontFamily:"Lato, Arial, sans-serif",color:"white",fontWeight:"3"},variant:"h5",component:"h2"},"Spatiotemporal Analysis"),o.a.createElement($.a,{variant:"body2",color:"textSecondary"},"Upload your shape and obtain your analysis")),o.a.createElement(de.a,{style:sa.content},o.a.createElement(Ht,null),o.a.createElement(L.a,{style:sa.closeBtn,"aria-label":"Close",onClick:this.handleCloseClick},o.a.createElement(I.a,{fontSize:"inherit"},"chevron_right"))))))}}]),t}(o.a.Component),da=["Date Selection","Choose Index Type","Upload Data"];function pa(e){var t=e.onSubmit,a=Object(n.useState)(0),r=Object(He.a)(a,2),i=r[0],l=r[1],s=Object(n.useState)(!1),c=Object(He.a)(s,2),d=(c[0],c[1]),p=Object(n.useState)({startDate:"",endDate:"",indexType:"",aoiDataFiles:[]}),u=Object(He.a)(p,2),m=u[0],h=u[1],g=function(){var e=Object(z.a)(N.a.mark(function e(){return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:d(!0);try{t([m])}catch(a){console.error("Error fetching data: ",a)}d(!1);case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),f=function(e){h(Object(ve.a)({},m,Object(fe.a)({},e.target.name,e.target.value)))};return o.a.createElement(Dt.a,{sx:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}},o.a.createElement(Tt.a,{activeStep:i,sx:{width:"80%",marginBottom:2}},da.map(function(e){return o.a.createElement(Pt.a,{key:e},o.a.createElement(Bt.a,null,e))})),o.a.createElement("div",null,i===da.length?o.a.createElement(o.a.Fragment,null,o.a.createElement(Ct.a,{sx:{mt:2,mb:1}},"All steps completed - you're finished"),o.a.createElement(xt.a,{onClick:function(){l(0),h({startDate:"",endDate:"",indexType:"",soilDataFiles:[],aoiDataFiles:[]})}},"Reset")):o.a.createElement(o.a.Fragment,null,function(e){switch(e){case 0:return o.a.createElement(Dt.a,{sx:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"}},o.a.createElement(bt.a,{label:"Start Date",type:"date",name:"startDate",value:m.startDate,onChange:f,InputLabelProps:{shrink:!0},sx:{margin:1}}),o.a.createElement(bt.a,{label:"End Date",type:"date",name:"endDate",value:m.endDate,onChange:f,InputLabelProps:{shrink:!0},sx:{margin:1}}));case 1:return o.a.createElement(Dt.a,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}},o.a.createElement(jt.a,{id:"index-type-label"},"Index Type"),o.a.createElement(At.a,{labelId:"index-type-label",id:"index-type-select",value:m.indexType,onChange:f,name:"indexType",sx:{width:200,margin:1}},o.a.createElement(Ft.a,{value:"NDVI"},"NDVI"),o.a.createElement(Ft.a,{value:"EVI"},"EVI"),o.a.createElement(Ft.a,{value:"GNDVI"},"GNDVI")));case 2:return o.a.createElement(Dt.a,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}},o.a.createElement($e.a,{onChange:function(e){return function(e,t){h(Object(ve.a)({},m,Object(fe.a)({},e,t)))}("aoiDataFiles",e)},acceptedFiles:[".zip"],dropzoneText:"\xc1rea",maxFileSize:5e6,filesLimit:1,style:{width:"100%",border:"dashed",cursor:"pointer",overflow:"hidden"}}));default:return"Unknown step"}}(i),o.a.createElement(Dt.a,{sx:{display:"flex",flexDirection:"row",pt:2,alignItems:"center",justifyContent:"center"}},o.a.createElement(xt.a,{disabled:0===i,onClick:function(){l(function(e){return e-1})}},"Back"),o.a.createElement(xt.a,{onClick:function(){i===da.length-1&&g(),l(function(e){return e+1})}},i===da.length-1?"Finish":"Next")))))}var ua=Object(gt.a)({palette:{primary:{main:Q.a.A200}}}),ma={root:{position:"fixed",top:74,right:10,borderRadius:4,minWidth:350,margin:0,zIndex:900},value:"2",rooot:{width:"100%"},heading:{fontSize:ua.typography.pxToRem(15),flexBasis:"33.33%",flexShrink:0},secondaryHeading:{fontSize:ua.typography.pxToRem(15),color:ua.palette.text.secondary},header:{backgroundColor:"rgb(138, 213, 137)"},content:{paddingBottom:16},closeBtn:{position:"absolute",top:6,right:8,fontSize:22},searchField:{display:"flex",alignItems:"center",width:"100%",height:40,padding:"2px 4px"},searchBox:{marginLeft:8,flex:1,border:"none !important"},searchBoxBtn:{padding:8},searchOptionsContainer:{padding:"5px 2px"},searchOption:{color:"rgba(0, 0, 0, 0.6)",cursor:"pointer"},searchBoxProgress:{marginRight:8},searchBoxDivider:{width:1,height:28,margin:4},resultWrapperOpen:{maxWidth:800},resultWrapperClosed:{maxWidth:350},resultContainer:{paddingTop:0,paddingBottom:0},resultTable:{boxShadow:"none"},uploadBoxInput:{display:"none"},uploadBoxBtnEdit:{width:40,height:40,lineHeight:"40px",textAlign:"center",borderRadius:"50%",fontSize:22},wrapBtn:{position:"absolute",bottom:12,left:18,padding:10,fontSize:24},addPointWrapperOpen:{maxWidth:350},addPointWrapperClose:{width:0},uploadBoxBtnAdd:{width:90,height:90,lineHeight:"90px",textAlign:"center",borderRadius:"50%",fontSize:30,backgroundColor:"rgba(0, 0, 0, 0.08)"},previewImageContainer:{display:"flex",alignItems:"center"},nameTextField:{margin:"0 20px 0 13px"},pinyinTextField:{margin:"10px 20px 10px 13px"},introTextField:{width:"100%",marginTop:5},locationImageContainer:{display:"flex",flexDirection:"column",alignItems:"center"},locationImage:{display:"block",marginTop:5,width:225,height:140,borderRadius:3,cursor:"pointer"},locationLabel:{display:"block",marginTop:6},actions:{paddingTop:10},saveBtn:{display:"inline-block",position:"relative",marginRight:10},saveBtnProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}},ha=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={open:!1},a.handleCloseClick=function(){a.setState({open:!1})},a.handleChange=function(e,t){a.setState({value:t})},a.handleDataSubmit=function(e){if(console.log(e),e[0].aoiDataFiles){console.log(e[0].startDate);var t=new FormData;t.append("startDate",e[0].startDate),t.append("endDate",e[0].endDate),t.append("indexType",e[0].indexType),t.append("aoiDataFiles",e[0].aoiDataFiles[0]),console.log(t),fetch("http://localhost:5004/get_image",{method:"POST",body:t}).then(function(e){return e.json()}).then(function(e){console.log(e.output),a.setState({url:e.output}),f.emit("moveURL",a.state.url)}).catch(function(e){return console.error("Error:",e)})}else if(e[1]){var n=new FormData;n.append("startDate",e[0].startDate),n.append("endDate",e[0].endDate),n.append("indexType",e[0].indexType),n.append("geojson",JSON.stringify(e[1])),console.log(n),console.log(e[1]),fetch("http://localhost:5004/get_image",{method:"POST",body:n}).then(function(e){return e.json()}).then(function(e){console.log(e.output),a.setState({url:e.output}),f.emit("moveURL",a.state.url)}).catch(function(e){return console.error("Error:",e)})}else console.error("No data to send: you must provide either a file or geoJSON data.")},a.handleWrapClick=function(){f.emit("removeTempLayer"),a.resetPreviewImage(),document.getElementById("search-box").value="",a.setState({resultUnwrap:!1})},a.moveURL=function(){var e=a.state.url;a.setState({movedURL:e}),console.log(a.state.movedURL)},a.handleSearchOptionChange=function(e){var t=null,n=!1;if(a.state.searchOptions.map(function(a){return a.value===e.currentTarget.value&&(a.checked=e.currentTarget.checked,t=a),n=n||a.checked,!0}),!n)return f.emit("showSnackbar","error","Error: Please select at least one option."),void(t.checked=!0);a.setState({searchOptions:a.state.searchOptions})},a.moveURL=function(){var e=a.state.url;a.setState({movedURL:e}),console.log(a.state.movedURL)},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=document.getElementById("anchorEl"),a=new FileReader;a.onload=function(t){var a=new Image;a.src=t.target.result;var n={longitude:a.height>a.width,src:t.target.result};e.setState({previewImage:n})},this.setState({reader:a,anchorEl:t}),this.openBandControllerListener=f.addListener("openBandController",function(){e.setState({open:!0})}),this.closeAllControllerListener=f.addListener("closeAllController",function(){e.setState({open:!1})}),this.updatePointListener=f.addListener("setPoint",function(t,a,n){var o=Object(He.a)(t.geometry.coordinates,2),r=o[0],i=o[1],l="https://api.mapbox.com/styles/v1/".concat(a,"/static/pin-s+f00(").concat(r,",").concat(i,")/").concat(r,",").concat(i,",").concat(n,",0,1/250x155@2x?access_token=").concat(_e);e.setState({addPointUnwrap:!0,previewMapUrl:l,geometry:t,previewCoordinate:{lng:parseFloat(r).toFixed(3),lat:parseFloat(i).toFixed(3)}})}),this.moveURListener=f.addListener("moveURL",function(){e.moveURL()})}},{key:"componentWillUnmount",value:function(){f.removeListener(this.openBandControllerListener),f.removeListener(this.closeAllControllerListener),f.removeListener(this.addPointListener),f.removeListener(this.updatePointListener),f.removeListener(this.moveURListener),document.querySelectorAll(".materialboxed").map(function(e){return e.destory()})}},{key:"render",value:function(){var e=this;return o.a.createElement(ft.a,{theme:ua},o.a.createElement(J.a,{direction:"left",in:this.state.open},o.a.createElement(ce.a,{style:ma.root},o.a.createElement(de.a,{style:ma.header},o.a.createElement($.a,{gutterBottom:!0,style:{fontFamily:"Lato, Arial, sans-serif",color:"white",fontWeight:"3"},variant:"h5",component:"h2"},"C\xe1lculo de variables"),o.a.createElement($.a,{variant:"body2",color:"textSecondary"},"Tanto ambientales como meteorol\xf3gicas"),o.a.createElement(L.a,{style:ma.closeBtn,"aria-label":"Close",onClick:function(){return e.setState({open:!1})}},o.a.createElement(I.a,{fontSize:"inherit"},"chevron_right"))),o.a.createElement(de.a,{style:ma.content},o.a.createElement(Dt.a,{sx:{borderBottom:1,borderColor:"divider"}}),o.a.createElement(pa,{onSubmit:this.handleDataSubmit}),o.a.createElement(L.a,{style:ma.closeBtn,"aria-label":"Close",onClick:this.handleCloseClick},o.a.createElement(I.a,{fontSize:"inherit"},"chevron_right"))))))}}]),t}(o.a.Component),ga=a(581),fa=a(573),va=a(577),ya=Object(O.b)({palette:{primary:{main:Q.a.A200}}}),ba={root:{position:"fixed",top:74,right:10,borderRadius:4,minWidth:350,margin:0,zIndex:900},header:{backgroundColor:"rgb(138, 213, 137)"},closeBtn:{position:"absolute",top:6,right:8,fontSize:22},searchField:{display:"flex",alignItems:"center",width:"100%",height:40,padding:"2px 4px"},searchBox:{marginLeft:8,flex:1,border:"none !important"},searchBoxBtn:{padding:8},searchOptionsContainer:{padding:"5px 2px"},searchOption:{color:"rgba(0, 0, 0, 0.6)",cursor:"pointer"},searchBoxProgress:{marginRight:8},searchBoxDivider:{width:1,height:28,margin:4},resultWrapperOpen:{maxWidth:800},resultWrapperClosed:{maxWidth:350},resultContainer:{paddingTop:0,paddingBottom:0},resultTable:{boxShadow:"none"},uploadBoxInput:{display:"none"},uploadBoxBtnEdit:{width:40,height:40,lineHeight:"40px",textAlign:"center",borderRadius:"50%",fontSize:22},wrapBtn:{position:"absolute",bottom:12,left:18,padding:10,fontSize:24},addPointWrapperOpen:{maxWidth:350},addPointWrapperClose:{width:0},uploadBoxBtnAdd:{width:90,height:90,lineHeight:"90px",textAlign:"center",borderRadius:"50%",fontSize:30,backgroundColor:"rgba(0, 0, 0, 0.08)"},previewImageContainer:{display:"flex",alignItems:"center"},nameTextField:{margin:"0 20px 0 13px"},pinyinTextField:{margin:"10px 20px 10px 13px"},introTextField:{width:"100%",marginTop:5},locationImageContainer:{display:"flex",flexDirection:"column",alignItems:"center"},locationImage:{display:"block",marginTop:5,width:225,height:140,borderRadius:3,cursor:"pointer"},locationLabel:{display:"block",marginTop:6},actions:{paddingTop:10},saveBtn:{display:"inline-block",position:"relative",marginRight:10},saveBtnProgress:{position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}},xa=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={Ic:0,Ih:0,Ig:0,Io:0,If:0,IoType:0,activeTab:0,sustainabilityIndex:null,decision:null,open:!1,resultUnwrap:!1,addPointUnwrap:!1,optionsOpen:!1,searching:!1,submitting:!1,anchorEl:null,geometry:null,previewImage:null,previewMapUrl:null,previewCoordinate:{},loading:!1,traces:[],precipitationData:[],temperatureData:[],watsatData:[],shannonIndex:null,chao1Index:null,chao2Index:null,error:null,layoutTemperature:{title:"Temperatura del Aire HC",xaxis:{title:"Fecha",type:"date"},yaxis:{title:"Temperatura (\xb0C)"}},layoutPrecipitation:{title:"Precipitaci\xf3n",xaxis:{title:"Fecha",type:"date"},yaxis:{title:"Precipitaci\xf3n (mm)"}},layoutWatsat:{title:"Modelo Watsat",xaxis:{title:"Fecha",type:"date"},yaxis:{title:"Contenido Volum\xe9trico de Agua"}},layout:{barmode:"stack",title:"Avistamientos de insectos por d\xeda",xaxis:{title:"Fecha",type:"date"},yaxis:{title:"Cantidad"}},items:[{id:1,title:"item #1"},{id:2,title:"item #2"},{id:3,title:"item #3"},{id:4,title:"item #4"},{id:5,title:"item #5"}],data:[],searchOptions:[{value:"gid",label:"Gid",checked:!0},{value:"name",label:"Name",checked:!0},{value:"pinyin",label:"Pinyin",checked:!0},{value:"introduction",label:"Introduction",checked:!1}]},a.calculateSustainabilityIndex=function(){var e=1===a.state.Io?a.state.IoType:0,t=2.45*a.state.Ic+2.18*a.state.Ih+1.64*a.state.Ig+1.09*e+1*a.state.If;a.setState({sustainabilityIndex:t})},a.handleDecision=function(e){a.setState({decision:e})},a.initMaterialbox=function(){var e=document.querySelectorAll(".materialboxed");x.a.Materialbox.init(e,{onOpenStart:function(e){e.parentNode.style.overflow="visible"},onCloseEnd:function(e){e.parentNode.style.overflow="hidden"}})},a.resetPreviewImage=function(){a.setState({previewImage:null})},a.resetNewPointData=function(){a.setState({previewMapUrl:null,geometry:null,previewCoordinate:{}})},a.handleCloseClick=function(){a.setState({open:!1})},a.handleAddClick=function(){f.emit("getPoint"),a.handleWrapClick(),a.resetPreviewImage(),a.resetNewPointData(),a.setState({addPointUnwrap:!1})},a.handleWrapClick=function(){f.emit("removeTempLayer"),a.resetPreviewImage(),document.getElementById("search-box").value="",a.setState({resultUnwrap:!1})},a.handleImageChange=function(e){e.target.files[0]&&(e.target.files[0].size>1048576?f.emit("showSnackbar","error","Error: Image must be smaller than 1MB."):a.state.reader.readAsDataURL(e.target.files[0]))},a.handleDoneEdit=function(){a.resetPreviewImage(),setTimeout(a.initMaterialbox,800)},a.handleSearchOptionsClick=function(){a.setState({optionsOpen:!0})},a.handleSearchOptionsClose=function(){a.setState({optionsOpen:!1})},a.handleSearchOptionChange=function(e){var t=null,n=!1;if(a.state.searchOptions.map(function(a){return a.value===e.currentTarget.value&&(a.checked=e.currentTarget.checked,t=a),n=n||a.checked,!0}),!n)return f.emit("showSnackbar","error","Error: Please select at least one option."),void(t.checked=!0);a.setState({searchOptions:a.state.searchOptions})},a.handleSearchClick=function(){if(a.handleCancelClick(),document.getElementById("search-box").value){a.setState({searching:!0});var e={};a.state.searchOptions.map(function(t){return e[t.value]=t.checked,!0})}},a.handlePreviewClick=function(e,t){f.emit("displayTempLayer",t)},a.handlePreviewMapClick=function(){f.emit("getPoint"),a.setState({addPointUnwrap:!1})},a.handleSelectChange=function(e){a.setState(Object(fe.a)({},e.target.name,Number(e.target.value)))},a.calculateSustainabilityIndex=function(){var e=a.state,t=e.Ic,n=e.Ih,o=e.Ig,r=e.Io,i=e.If,l=e.IoType,s=2.45*t+2.18*n+1.64*o+1.09*(1===r?l:0)+1*i;a.setState({sustainabilityIndex:s})},a.handleCalculate=function(){var e=Object(z.a)(N.a.mark(function e(t,n){var o,r;return N.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.setState({error:null,loading:!0}),e.prev=1,e.next=4,fetch(t);case 4:if((o=e.sent).ok){e.next=7;break}throw new Error("Error al procesar la solicitud");case 7:return e.next=9,o.json();case 9:r=e.sent,a.setState(Object(fe.a)({},n,r)),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),console.error(e.t0),a.setState({error:"Error al calcular el \xedndice. Intenta nuevamente."});case 17:return e.prev=17,a.setState({loading:!1}),e.finish(17);case 20:case"end":return e.stop()}},e,null,[[1,13,17,20]])}));return function(t,a){return e.apply(this,arguments)}}(),a.renderTabContent=function(e){var t=a.state,n=t.loading,r=t.error,i=t.shannonIndex,l=t.chao1Index,s=t.chao2Index;return 0===e?o.a.createElement(o.a.Fragment,null,o.a.createElement(g.a,{variant:"contained",color:"primary",style:ba.button,onClick:function(){return a.handleCalculate("http://localhost:5003/api/shannon","shannonIndex")},disabled:n},"Calcular \xcdndice Shannon"),n&&o.a.createElement(G.a,{style:ba.loading}),r&&o.a.createElement($.a,{color:"error",style:ba.result},r),i&&o.a.createElement($.a,{style:ba.result},"\xcdndice de Shannon: ",i.shannon_index.toFixed(2))):1===e?o.a.createElement(o.a.Fragment,null,o.a.createElement(g.a,{variant:"contained",color:"primary",style:ba.button,onClick:function(){return a.handleCalculate("http://localhost:5003/api/chao1","chao1Index")},disabled:n},"Calcular \xcdndice Chao1"),n&&o.a.createElement(G.a,{style:ba.loading}),r&&o.a.createElement($.a,{color:"error",style:ba.result},r),l&&o.a.createElement($.a,{style:ba.result},"\xcdndice Chao1: ",l.chao1_index.toFixed(2))):2===e?o.a.createElement(o.a.Fragment,null,o.a.createElement(g.a,{variant:"contained",color:"primary",style:ba.button,onClick:function(){return a.handleCalculate("http://localhost:5003/api/chao2","chao2Index")},disabled:n},"Calcular \xcdndice Chao2"),n&&o.a.createElement(G.a,{style:ba.loading}),r&&o.a.createElement($.a,{color:"error",style:ba.result},r),s&&o.a.createElement($.a,{style:ba.result},"\xcdndice Chao2: ",s.chao2_index.toFixed(2))):null},a.handleTabChange=function(e,t){a.setState({activeTab:t})},a}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=document.getElementById("anchorEl"),a=new FileReader;a.onload=function(t){var a=new Image;a.src=t.target.result;var n={longitude:a.height>a.width,src:t.target.result};e.setState({previewImage:n})},this.setState({reader:a,anchorEl:t}),this.openBiodivControllerListener=f.addListener("openBiodivController",function(){e.setState({open:!0})}),this.closeAllControllerListener=f.addListener("closeAllController",function(){e.setState({open:!1})}),this.updatePointListener=f.addListener("setPoint",function(t,a,n){var o=Object(He.a)(t.geometry.coordinates,2),r=o[0],i=o[1],l="https://api.mapbox.com/styles/v1/".concat(a,"/static/pin-s+f00(").concat(r,",").concat(i,")/").concat(r,",").concat(i,",").concat(n,",0,1/250x155@2x?access_token=").concat(_e);e.setState({addPointUnwrap:!0,previewMapUrl:l,geometry:t,previewCoordinate:{lng:parseFloat(r).toFixed(3),lat:parseFloat(i).toFixed(3)}})})}},{key:"setIc",value:function(e){this.setState({Ic:e})}},{key:"setIh",value:function(e){this.setState({Ih:e})}},{key:"setIg",value:function(e){this.setState({Ig:e})}},{key:"setIo",value:function(e){this.setState({Io:e})}},{key:"setIoType",value:function(e){this.setState({IoType:e})}},{key:"setIf",value:function(e){this.setState({If:e})}},{key:"componentWillUnmount",value:function(){f.removeListener(this.openBiodivControllerListener),f.removeListener(this.closeAllControllerListener),f.removeListener(this.addPointListener),f.removeListener(this.updatePointListener),document.querySelectorAll(".materialboxed").map(function(e){return e.destory()})}},{key:"render",value:function(){var e=this,t=this.state.activeTab;return o.a.createElement(D.a,{theme:ya},o.a.createElement(J.a,{direction:"left",in:this.state.open},o.a.createElement(ce.a,{style:ba.root},o.a.createElement(de.a,{style:ba.header},o.a.createElement($.a,{gutterBottom:!0,style:{fontFamily:"Lato, Arial, sans-serif",color:"white",fontWeight:"3"},variant:"h5",component:"h2"},"C\xe1lculo de \xcdndices de Biodiversidad"),o.a.createElement($.a,{variant:"body2",color:"textSecondary"},"C\xe1lculo de \xcdndices de Biodiversidad"),o.a.createElement(L.a,{style:ba.closeBtn,"aria-label":"Close",onClick:function(){return e.setState({open:!1})}},o.a.createElement(I.a,{fontSize:"inherit"},"chevron_right"))),o.a.createElement(ga.a,{value:t,onChange:this.handleTabChange,indicatorColor:"secondary",textColor:"inherit",variant:"fullWidth",style:ba.tabs},o.a.createElement(fa.a,{label:"Shannon"}),o.a.createElement(fa.a,{label:"Chao1"}),o.a.createElement(fa.a,{label:"Chao2"})),o.a.createElement(de.a,null,o.a.createElement(va.a,null,this.renderTabContent(t))))))}}]),t}(o.a.Component),Ca=function(e){function t(){return Object(c.a)(this,t),Object(p.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return o.a.createElement(h.SnackbarProvider,{maxSnack:3},o.a.createElement(o.a.Fragment,null,o.a.createElement(y,null),o.a.createElement(E,null),o.a.createElement(A,null),o.a.createElement(M,null),o.a.createElement(le,null),o.a.createElement(se,null),o.a.createElement(ht,null),o.a.createElement(ha,null),o.a.createElement(Ot,null),o.a.createElement(ca,null),o.a.createElement(xa,null),o.a.createElement(ia,null),o.a.createElement(he,null),o.a.createElement(we,null),o.a.createElement(Yt,null),o.a.createElement(Gt,null),o.a.createElement(ta,null),o.a.createElement(lt,null),o.a.createElement(ze,null),o.a.createElement(Me,null)))}}]),t}(o.a.Component),Ea=function(){return o.a.createElement(l.a,null,o.a.createElement(s.c,null,o.a.createElement(s.a,{exact:!0,path:"/",component:Ca})))},Sa=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function wa(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}i.a.render(o.a.createElement(function(){return o.a.createElement(Ea,null)},null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("","/service-worker.js");Sa?(function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):wa(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):wa(t,e)})}}()},92:function(e,t,a){}},[[317,1,2]]]);
//# sourceMappingURL=main.5e6165ce.chunk.js.map